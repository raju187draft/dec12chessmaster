{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///home/rajunew/aa/decchessd/lib/chess-engine.ts"],"sourcesContent":["// Chess piece types and board representation\nexport type PieceType = \"p\" | \"n\" | \"b\" | \"r\" | \"q\" | \"k\"\nexport type PieceColor = \"w\" | \"b\"\nexport type Piece = { type: PieceType; color: PieceColor } | null\nexport type Square = string // e.g., 'e4', 'a1'\nexport type Move = {\n  from: Square\n  to: Square\n  piece: PieceType\n  captured?: PieceType\n  promotion?: PieceType\n  castle?: \"k\" | \"q\"\n  enPassant?: boolean\n  check?: boolean\n  checkmate?: boolean\n}\n\nexport type GameState = {\n  board: Piece[][]\n  turn: PieceColor\n  castling: { w: { k: boolean; q: boolean }; b: { k: boolean; q: boolean } }\n  enPassant: Square | null\n  halfMoves: number\n  fullMoves: number\n  history: Move[]\n  isCheck: boolean\n  isCheckmate: boolean\n  isStalemate: boolean\n  isDraw: boolean\n}\n\nconst INITIAL_BOARD: Piece[][] = [\n  [\n    { type: \"r\", color: \"b\" },\n    { type: \"n\", color: \"b\" },\n    { type: \"b\", color: \"b\" },\n    { type: \"q\", color: \"b\" },\n    { type: \"k\", color: \"b\" },\n    { type: \"b\", color: \"b\" },\n    { type: \"n\", color: \"b\" },\n    { type: \"r\", color: \"b\" },\n  ],\n  [\n    { type: \"p\", color: \"b\" },\n    { type: \"p\", color: \"b\" },\n    { type: \"p\", color: \"b\" },\n    { type: \"p\", color: \"b\" },\n    { type: \"p\", color: \"b\" },\n    { type: \"p\", color: \"b\" },\n    { type: \"p\", color: \"b\" },\n    { type: \"p\", color: \"b\" },\n  ],\n  [null, null, null, null, null, null, null, null],\n  [null, null, null, null, null, null, null, null],\n  [null, null, null, null, null, null, null, null],\n  [null, null, null, null, null, null, null, null],\n  [\n    { type: \"p\", color: \"w\" },\n    { type: \"p\", color: \"w\" },\n    { type: \"p\", color: \"w\" },\n    { type: \"p\", color: \"w\" },\n    { type: \"p\", color: \"w\" },\n    { type: \"p\", color: \"w\" },\n    { type: \"p\", color: \"w\" },\n    { type: \"p\", color: \"w\" },\n  ],\n  [\n    { type: \"r\", color: \"w\" },\n    { type: \"n\", color: \"w\" },\n    { type: \"b\", color: \"w\" },\n    { type: \"q\", color: \"w\" },\n    { type: \"k\", color: \"w\" },\n    { type: \"b\", color: \"w\" },\n    { type: \"n\", color: \"w\" },\n    { type: \"r\", color: \"w\" },\n  ],\n]\n\nexport function createInitialState(): GameState {\n  return {\n    board: INITIAL_BOARD.map((row) => row.map((piece) => (piece ? { ...piece } : null))),\n    turn: \"w\",\n    castling: { w: { k: true, q: true }, b: { k: true, q: true } },\n    enPassant: null,\n    halfMoves: 0,\n    fullMoves: 1,\n    history: [],\n    isCheck: false,\n    isCheckmate: false,\n    isStalemate: false,\n    isDraw: false,\n  }\n}\n\nexport function squareToCoords(square: Square): [number, number] {\n  const col = square.charCodeAt(0) - 97\n  const row = 8 - Number.parseInt(square[1])\n  return [row, col]\n}\n\nexport function coordsToSquare(row: number, col: number): Square {\n  return String.fromCharCode(97 + col) + (8 - row)\n}\n\nexport function getPieceAt(state: GameState, square: Square): Piece {\n  const [row, col] = squareToCoords(square)\n  return state.board[row]?.[col] ?? null\n}\n\nfunction setPieceAt(board: Piece[][], square: Square, piece: Piece): void {\n  const [row, col] = squareToCoords(square)\n  board[row][col] = piece\n}\n\nfunction cloneBoard(board: Piece[][]): Piece[][] {\n  return board.map((row) => row.map((piece) => (piece ? { ...piece } : null)))\n}\n\nfunction cloneState(state: GameState): GameState {\n  return {\n    board: cloneBoard(state.board),\n    turn: state.turn,\n    castling: {\n      w: { ...state.castling.w },\n      b: { ...state.castling.b },\n    },\n    enPassant: state.enPassant,\n    halfMoves: state.halfMoves,\n    fullMoves: state.fullMoves,\n    history: [...state.history],\n    isCheck: state.isCheck,\n    isCheckmate: state.isCheckmate,\n    isStalemate: state.isStalemate,\n    isDraw: state.isDraw,\n  }\n}\n\n// Get pseudo-legal moves (doesn't check for leaving king in check)\nfunction getPseudoLegalMoves(state: GameState, square: Square): Square[] {\n  const piece = getPieceAt(state, square)\n  if (!piece) return []\n\n  const [row, col] = squareToCoords(square)\n  const moves: Square[] = []\n\n  switch (piece.type) {\n    case \"p\":\n      moves.push(...getPawnMoves(state, row, col, piece.color))\n      break\n    case \"n\":\n      moves.push(...getKnightMoves(state, row, col, piece.color))\n      break\n    case \"b\":\n      moves.push(...getBishopMoves(state, row, col, piece.color))\n      break\n    case \"r\":\n      moves.push(...getRookMoves(state, row, col, piece.color))\n      break\n    case \"q\":\n      moves.push(...getQueenMoves(state, row, col, piece.color))\n      break\n    case \"k\":\n      moves.push(...getKingMoves(state, row, col, piece.color))\n      break\n  }\n\n  return moves\n}\n\n// Get all valid moves for a piece at a given square\nexport function getValidMoves(state: GameState, square: Square): Square[] {\n  const piece = getPieceAt(state, square)\n  if (!piece || piece.color !== state.turn) return []\n\n  const moves = getPseudoLegalMoves(state, square)\n\n  // Filter out moves that would leave king in check\n  return moves.filter((to) => {\n    const testState = makeQuickMove(state, square, to)\n    return !isKingInCheck(testState, piece.color)\n  })\n}\n\nfunction getPawnMoves(state: GameState, row: number, col: number, color: PieceColor): Square[] {\n  const moves: Square[] = []\n  const direction = color === \"w\" ? -1 : 1\n  const startRow = color === \"w\" ? 6 : 1\n\n  // Forward move\n  const newRow = row + direction\n  if (newRow >= 0 && newRow < 8 && !state.board[newRow][col]) {\n    moves.push(coordsToSquare(newRow, col))\n\n    // Double move from start\n    if (row === startRow && !state.board[row + 2 * direction][col]) {\n      moves.push(coordsToSquare(row + 2 * direction, col))\n    }\n  }\n\n  // Captures\n  for (const dc of [-1, 1]) {\n    const newCol = col + dc\n    if (newCol >= 0 && newCol < 8 && newRow >= 0 && newRow < 8) {\n      const target = state.board[newRow]?.[newCol]\n      if (target && target.color !== color) {\n        moves.push(coordsToSquare(newRow, newCol))\n      }\n\n      // En passant\n      if (state.enPassant === coordsToSquare(newRow, newCol)) {\n        moves.push(coordsToSquare(newRow, newCol))\n      }\n    }\n  }\n\n  return moves\n}\n\nfunction getKnightMoves(state: GameState, row: number, col: number, color: PieceColor): Square[] {\n  const moves: Square[] = []\n  const offsets = [\n    [-2, -1],\n    [-2, 1],\n    [-1, -2],\n    [-1, 2],\n    [1, -2],\n    [1, 2],\n    [2, -1],\n    [2, 1],\n  ]\n\n  for (const [dr, dc] of offsets) {\n    const newRow = row + dr\n    const newCol = col + dc\n    if (newRow >= 0 && newRow < 8 && newCol >= 0 && newCol < 8) {\n      const target = state.board[newRow][newCol]\n      if (!target || target.color !== color) {\n        moves.push(coordsToSquare(newRow, newCol))\n      }\n    }\n  }\n\n  return moves\n}\n\nfunction getSlidingMoves(\n  state: GameState,\n  row: number,\n  col: number,\n  color: PieceColor,\n  directions: number[][],\n): Square[] {\n  const moves: Square[] = []\n\n  for (const [dr, dc] of directions) {\n    let newRow = row + dr\n    let newCol = col + dc\n\n    while (newRow >= 0 && newRow < 8 && newCol >= 0 && newCol < 8) {\n      const target = state.board[newRow][newCol]\n      if (!target) {\n        moves.push(coordsToSquare(newRow, newCol))\n      } else {\n        if (target.color !== color) {\n          moves.push(coordsToSquare(newRow, newCol))\n        }\n        break\n      }\n      newRow += dr\n      newCol += dc\n    }\n  }\n\n  return moves\n}\n\nfunction getBishopMoves(state: GameState, row: number, col: number, color: PieceColor): Square[] {\n  return getSlidingMoves(state, row, col, color, [\n    [-1, -1],\n    [-1, 1],\n    [1, -1],\n    [1, 1],\n  ])\n}\n\nfunction getRookMoves(state: GameState, row: number, col: number, color: PieceColor): Square[] {\n  return getSlidingMoves(state, row, col, color, [\n    [-1, 0],\n    [1, 0],\n    [0, -1],\n    [0, 1],\n  ])\n}\n\nfunction getQueenMoves(state: GameState, row: number, col: number, color: PieceColor): Square[] {\n  return [...getBishopMoves(state, row, col, color), ...getRookMoves(state, row, col, color)]\n}\n\nfunction getKingMoves(state: GameState, row: number, col: number, color: PieceColor): Square[] {\n  const moves: Square[] = []\n  const offsets = [\n    [-1, -1],\n    [-1, 0],\n    [-1, 1],\n    [0, -1],\n    [0, 1],\n    [1, -1],\n    [1, 0],\n    [1, 1],\n  ]\n\n  for (const [dr, dc] of offsets) {\n    const newRow = row + dr\n    const newCol = col + dc\n    if (newRow >= 0 && newRow < 8 && newCol >= 0 && newCol < 8) {\n      const target = state.board[newRow][newCol]\n      if (!target || target.color !== color) {\n        moves.push(coordsToSquare(newRow, newCol))\n      }\n    }\n  }\n\n  // Castling\n  const castleRow = color === \"w\" ? 7 : 0\n  if (row === castleRow && col === 4 && !isKingInCheck(state, color)) {\n    // Kingside\n    if (\n      state.castling[color].k &&\n      !state.board[castleRow][5] &&\n      !state.board[castleRow][6] &&\n      state.board[castleRow][7]?.type === \"r\"\n    ) {\n      const test1 = makeQuickMove(state, coordsToSquare(row, col), coordsToSquare(row, 5))\n      const test2 = makeQuickMove(state, coordsToSquare(row, col), coordsToSquare(row, 6))\n      if (!isKingInCheck(test1, color) && !isKingInCheck(test2, color)) {\n        moves.push(coordsToSquare(castleRow, 6))\n      }\n    }\n    // Queenside\n    if (\n      state.castling[color].q &&\n      !state.board[castleRow][3] &&\n      !state.board[castleRow][2] &&\n      !state.board[castleRow][1] &&\n      state.board[castleRow][0]?.type === \"r\"\n    ) {\n      const test1 = makeQuickMove(state, coordsToSquare(row, col), coordsToSquare(row, 3))\n      const test2 = makeQuickMove(state, coordsToSquare(row, col), coordsToSquare(row, 2))\n      if (!isKingInCheck(test1, color) && !isKingInCheck(test2, color)) {\n        moves.push(coordsToSquare(castleRow, 2))\n      }\n    }\n  }\n\n  return moves\n}\n\nfunction findKing(state: GameState, color: PieceColor): Square | null {\n  for (let row = 0; row < 8; row++) {\n    for (let col = 0; col < 8; col++) {\n      const piece = state.board[row][col]\n      if (piece?.type === \"k\" && piece.color === color) {\n        return coordsToSquare(row, col)\n      }\n    }\n  }\n  return null\n}\n\nexport function isKingInCheck(state: GameState, color: PieceColor): boolean {\n  const kingSquare = findKing(state, color)\n  if (!kingSquare) return false\n\n  const [kingRow, kingCol] = squareToCoords(kingSquare)\n  const enemyColor = color === \"w\" ? \"b\" : \"w\"\n\n  // Check for attacks from each piece type\n  // Knights\n  const knightOffsets = [\n    [-2, -1],\n    [-2, 1],\n    [-1, -2],\n    [-1, 2],\n    [1, -2],\n    [1, 2],\n    [2, -1],\n    [2, 1],\n  ]\n  for (const [dr, dc] of knightOffsets) {\n    const r = kingRow + dr\n    const c = kingCol + dc\n    if (r >= 0 && r < 8 && c >= 0 && c < 8) {\n      const piece = state.board[r][c]\n      if (piece?.type === \"n\" && piece.color === enemyColor) return true\n    }\n  }\n\n  // Pawns\n  const pawnDir = color === \"w\" ? -1 : 1\n  for (const dc of [-1, 1]) {\n    const r = kingRow + pawnDir\n    const c = kingCol + dc\n    if (r >= 0 && r < 8 && c >= 0 && c < 8) {\n      const piece = state.board[r][c]\n      if (piece?.type === \"p\" && piece.color === enemyColor) return true\n    }\n  }\n\n  // King (for proximity checks)\n  const kingOffsets = [\n    [-1, -1],\n    [-1, 0],\n    [-1, 1],\n    [0, -1],\n    [0, 1],\n    [1, -1],\n    [1, 0],\n    [1, 1],\n  ]\n  for (const [dr, dc] of kingOffsets) {\n    const r = kingRow + dr\n    const c = kingCol + dc\n    if (r >= 0 && r < 8 && c >= 0 && c < 8) {\n      const piece = state.board[r][c]\n      if (piece?.type === \"k\" && piece.color === enemyColor) return true\n    }\n  }\n\n  // Sliding pieces (bishop, rook, queen)\n  const diagonals = [\n    [-1, -1],\n    [-1, 1],\n    [1, -1],\n    [1, 1],\n  ]\n  const straights = [\n    [-1, 0],\n    [1, 0],\n    [0, -1],\n    [0, 1],\n  ]\n\n  for (const [dr, dc] of diagonals) {\n    let r = kingRow + dr\n    let c = kingCol + dc\n    while (r >= 0 && r < 8 && c >= 0 && c < 8) {\n      const piece = state.board[r][c]\n      if (piece) {\n        if (piece.color === enemyColor && (piece.type === \"b\" || piece.type === \"q\")) {\n          return true\n        }\n        break\n      }\n      r += dr\n      c += dc\n    }\n  }\n\n  for (const [dr, dc] of straights) {\n    let r = kingRow + dr\n    let c = kingCol + dc\n    while (r >= 0 && r < 8 && c >= 0 && c < 8) {\n      const piece = state.board[r][c]\n      if (piece) {\n        if (piece.color === enemyColor && (piece.type === \"r\" || piece.type === \"q\")) {\n          return true\n        }\n        break\n      }\n      r += dr\n      c += dc\n    }\n  }\n\n  return false\n}\n\nfunction makeQuickMove(state: GameState, from: Square, to: Square): GameState {\n  const newBoard = cloneBoard(state.board)\n  const [fromRow, fromCol] = squareToCoords(from)\n  const [toRow, toCol] = squareToCoords(to)\n\n  const piece = state.board[fromRow][fromCol]\n  if (!piece) return state\n\n  newBoard[toRow][toCol] = { ...piece }\n  newBoard[fromRow][fromCol] = null\n\n  // Handle en passant capture\n  if (piece.type === \"p\" && to === state.enPassant) {\n    const captureRow = piece.color === \"w\" ? toRow + 1 : toRow - 1\n    newBoard[captureRow][toCol] = null\n  }\n\n  // Handle castling rook movement\n  if (piece.type === \"k\" && Math.abs(toCol - fromCol) === 2) {\n    if (toCol === 6) {\n      newBoard[fromRow][5] = newBoard[fromRow][7]\n      newBoard[fromRow][7] = null\n    } else if (toCol === 2) {\n      newBoard[fromRow][3] = newBoard[fromRow][0]\n      newBoard[fromRow][0] = null\n    }\n  }\n\n  return {\n    ...state,\n    board: newBoard,\n    turn: state.turn === \"w\" ? \"b\" : \"w\",\n  }\n}\n\nexport function makeMove(state: GameState, from: Square, to: Square, promotion?: PieceType): GameState | null {\n  const validMoves = getValidMoves(state, from)\n  if (!validMoves.includes(to)) return null\n\n  const newState = cloneState(state)\n  const [fromRow, fromCol] = squareToCoords(from)\n  const piece = newState.board[fromRow][fromCol]\n  if (!piece) return null\n\n  const [toRow, toCol] = squareToCoords(to)\n  const captured = newState.board[toRow][toCol]\n\n  // Create move record\n  const move: Move = {\n    from,\n    to,\n    piece: piece.type,\n    captured: captured?.type,\n  }\n\n  // Handle special moves\n  // En passant capture\n  if (piece.type === \"p\" && to === state.enPassant) {\n    const captureRow = piece.color === \"w\" ? toRow + 1 : toRow - 1\n    newState.board[captureRow][toCol] = null\n    move.enPassant = true\n    move.captured = \"p\"\n  }\n\n  // Castling\n  if (piece.type === \"k\" && Math.abs(toCol - fromCol) === 2) {\n    if (toCol === 6) {\n      // Kingside\n      newState.board[fromRow][5] = newState.board[fromRow][7]\n      newState.board[fromRow][7] = null\n      move.castle = \"k\"\n    } else if (toCol === 2) {\n      // Queenside\n      newState.board[fromRow][3] = newState.board[fromRow][0]\n      newState.board[fromRow][0] = null\n      move.castle = \"q\"\n    }\n  }\n\n  // Pawn promotion\n  if (piece.type === \"p\" && (toRow === 0 || toRow === 7)) {\n    piece.type = promotion || \"q\"\n    move.promotion = piece.type\n  }\n\n  // Move the piece\n  newState.board[toRow][toCol] = piece\n  newState.board[fromRow][fromCol] = null\n\n  // Update castling rights\n  if (piece.type === \"k\") {\n    newState.castling[piece.color].k = false\n    newState.castling[piece.color].q = false\n  }\n  if (piece.type === \"r\") {\n    if (fromCol === 0) newState.castling[piece.color].q = false\n    if (fromCol === 7) newState.castling[piece.color].k = false\n  }\n\n  // Set en passant square\n  if (piece.type === \"p\" && Math.abs(toRow - fromRow) === 2) {\n    newState.enPassant = coordsToSquare((fromRow + toRow) / 2, fromCol)\n  } else {\n    newState.enPassant = null\n  }\n\n  // Update move counters\n  if (piece.type === \"p\" || captured) {\n    newState.halfMoves = 0\n  } else {\n    newState.halfMoves++\n  }\n  if (piece.color === \"b\") {\n    newState.fullMoves++\n  }\n\n  // Switch turn\n  newState.turn = piece.color === \"w\" ? \"b\" : \"w\"\n\n  // Check for check/checkmate/stalemate\n  newState.isCheck = isKingInCheck(newState, newState.turn)\n  move.check = newState.isCheck\n\n  const hasLegalMoves = hasAnyLegalMove(newState)\n  if (!hasLegalMoves) {\n    if (newState.isCheck) {\n      newState.isCheckmate = true\n      move.checkmate = true\n    } else {\n      newState.isStalemate = true\n    }\n  }\n\n  // Check for draw by 50-move rule\n  if (newState.halfMoves >= 100) {\n    newState.isDraw = true\n  }\n\n  newState.history = [...state.history, move]\n\n  return newState\n}\n\nfunction hasAnyLegalMove(state: GameState): boolean {\n  for (let row = 0; row < 8; row++) {\n    for (let col = 0; col < 8; col++) {\n      const piece = state.board[row][col]\n      if (piece && piece.color === state.turn) {\n        const square = coordsToSquare(row, col)\n        const moves = getPseudoLegalMoves(state, square)\n        for (const to of moves) {\n          const testState = makeQuickMove(state, square, to)\n          if (!isKingInCheck(testState, piece.color)) {\n            return true // Found at least one legal move\n          }\n        }\n      }\n    }\n  }\n  return false\n}\n\nexport function getAllLegalMoves(state: GameState): { from: Square; to: Square }[] {\n  const moves: { from: Square; to: Square }[] = []\n\n  for (let row = 0; row < 8; row++) {\n    for (let col = 0; col < 8; col++) {\n      const piece = state.board[row][col]\n      if (piece && piece.color === state.turn) {\n        const square = coordsToSquare(row, col)\n        const validMoves = getValidMoves(state, square)\n        for (const to of validMoves) {\n          moves.push({ from: square, to })\n        }\n      }\n    }\n  }\n\n  return moves\n}\n\nexport function moveToAlgebraic(state: GameState, move: Move): string {\n  const pieceSymbols: Record<PieceType, string> = {\n    p: \"\",\n    n: \"N\",\n    b: \"B\",\n    r: \"R\",\n    q: \"Q\",\n    k: \"K\",\n  }\n\n  if (move.castle === \"k\") return \"O-O\"\n  if (move.castle === \"q\") return \"O-O-O\"\n\n  let notation = pieceSymbols[move.piece]\n\n  if (move.captured) {\n    if (move.piece === \"p\") {\n      notation += move.from[0]\n    }\n    notation += \"x\"\n  }\n\n  notation += move.to\n\n  if (move.promotion) {\n    notation += \"=\" + pieceSymbols[move.promotion]\n  }\n\n  if (move.checkmate) {\n    notation += \"#\"\n  } else if (move.check) {\n    notation += \"+\"\n  }\n\n  return notation\n}\n\n// Convert game state to FEN for AI analysis\nexport function gameStateToFEN(state: GameState): string {\n  const pieceToFEN: Record<string, string> = {\n    wp: \"P\",\n    wn: \"N\",\n    wb: \"B\",\n    wr: \"R\",\n    wq: \"Q\",\n    wk: \"K\",\n    bp: \"p\",\n    bn: \"n\",\n    bb: \"b\",\n    br: \"r\",\n    bq: \"q\",\n    bk: \"k\",\n  }\n\n  let fen = \"\"\n\n  // Board position\n  for (let row = 0; row < 8; row++) {\n    let empty = 0\n    for (let col = 0; col < 8; col++) {\n      const piece = state.board[row][col]\n      if (piece) {\n        if (empty > 0) {\n          fen += empty\n          empty = 0\n        }\n        fen += pieceToFEN[piece.color + piece.type]\n      } else {\n        empty++\n      }\n    }\n    if (empty > 0) fen += empty\n    if (row < 7) fen += \"/\"\n  }\n\n  fen += \" \" + state.turn\n\n  let castling = \"\"\n  if (state.castling.w.k) castling += \"K\"\n  if (state.castling.w.q) castling += \"Q\"\n  if (state.castling.b.k) castling += \"k\"\n  if (state.castling.b.q) castling += \"q\"\n  fen += \" \" + (castling || \"-\")\n\n  fen += \" \" + (state.enPassant || \"-\")\n  fen += \" \" + state.halfMoves\n  fen += \" \" + state.fullMoves\n\n  return fen\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 965, "column": 0}, "map": {"version":3,"sources":["file:///home/rajunew/aa/decchessd/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from 'clsx'\nimport { twMerge } from 'tailwind-merge'\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,sKAAO,EAAC,IAAA,6IAAI,EAAC;AACtB"}},
    {"offset": {"line": 980, "column": 0}, "map": {"version":3,"sources":["file:///home/rajunew/aa/decchessd/components/chess-board.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  type GameState,\n  getPieceAt,\n  type Square,\n  coordsToSquare,\n} from \"@/lib/chess-engine\";\nimport { cn } from \"@/lib/utils\";\n\ntype ChessBoardProps = {\n  gameState: GameState;\n  selectedSquare: Square | null;\n  validMoves: Square[];\n  lastMove: { from: Square; to: Square } | null;\n  aiLastMove: { from: Square; to: Square } | null; // Added AI move tracking\n  onSquareClick: (square: Square) => void;\n  flipped?: boolean;\n  isThinking?: boolean;\n  playerColor?: \"w\" | \"b\";\n};\n\nconst PIECE_SYMBOLS: Record<string, string> = {\n  wp: \"♙\",\n  wn: \"♘\",\n  wb: \"♗\",\n  wr: \"♖\",\n  wq: \"♕\",\n  wk: \"♔\",\n  bp: \"♟\",\n  bn: \"♞\",\n  bb: \"♝\",\n  br: \"♜\",\n  bq: \"♛\",\n  bk: \"♚\",\n};\n\nexport function ChessBoard({\n  gameState,\n  selectedSquare,\n  validMoves,\n  lastMove,\n  aiLastMove, // Added\n  onSquareClick,\n  flipped = false,\n  isThinking = false,\n  playerColor = \"w\",\n}: ChessBoardProps) {\n  const rows = flipped ? [7, 6, 5, 4, 3, 2, 1, 0] : [0, 1, 2, 3, 4, 5, 6, 7];\n  const cols = flipped ? [7, 6, 5, 4, 3, 2, 1, 0] : [0, 1, 2, 3, 4, 5, 6, 7];\n\n  const renderSquare = (row: number, col: number) => {\n    const square = coordsToSquare(row, col);\n    const piece = getPieceAt(gameState, square);\n    const isLight = (row + col) % 2 === 0;\n    const isSelected = selectedSquare === square;\n    const isValidMove = validMoves.includes(square);\n    const isPlayerMoveSquare =\n      lastMove?.from === square || lastMove?.to === square;\n    const isAIMoveSquare =\n      aiLastMove?.from === square || aiLastMove?.to === square;\n    const isCheck =\n      piece?.type === \"k\" &&\n      piece.color === gameState.turn &&\n      gameState.isCheck;\n    const hasPiece = piece !== null;\n    const isPlayerPiece = piece?.color === playerColor;\n    const isPlayerTurn = gameState.turn === playerColor;\n\n    return (\n      <button\n        key={square}\n        onClick={() => onSquareClick(square)}\n        disabled={isThinking}\n        className={cn(\n          \"relative aspect-square flex items-center justify-center transition-all\",\n          \"text-2xl sm:text-3xl md:text-4xl lg:text-5xl\",\n          isLight ? \"bg-board-light\" : \"bg-board-dark\",\n          isLight && \"wood-texture\",\n          isSelected && \"ring-2 ring-primary ring-inset\",\n          isPlayerMoveSquare && \"bg-yellow-400/50\",\n          isAIMoveSquare && !isPlayerMoveSquare && \"bg-blue-400/50\",\n          isCheck && \"bg-highlight-check\",\n          isThinking && \"cursor-not-allowed opacity-80\",\n          !isThinking &&\n            isPlayerPiece &&\n            isPlayerTurn &&\n            !isSelected &&\n            \"hover:brightness-110 cursor-pointer\"\n        )}\n      >\n        {isValidMove && (\n          <div\n            className={cn(\n              \"absolute inset-0 flex items-center justify-center z-10\",\n              hasPiece ? \"ring-2 ring-inset ring-primary/60\" : \"\"\n            )}\n          >\n            {!hasPiece && (\n              <div className=\"w-2 h-2 md:w-3 md:h-3 rounded-full bg-primary/50\" />\n            )}\n          </div>\n        )}\n\n        {piece && (\n          <span\n            className={cn(\n              \"select-none drop-shadow-md transition-transform relative z-0\",\n              piece.color === \"w\"\n                ? \"text-white [text-shadow:_1px_1px_2px_rgb(0_0_0_/_60%)]\"\n                : \"text-gray-900\",\n              isSelected && \"scale-110\"\n            )}\n          >\n            {PIECE_SYMBOLS[piece.color + piece.type]}\n          </span>\n        )}\n\n        {col === (flipped ? 7 : 0) && (\n          <span className=\"absolute left-0.5 top-0.5 text-[9px] font-medium text-muted-foreground/70\">\n            {8 - row}\n          </span>\n        )}\n        {row === (flipped ? 0 : 7) && (\n          <span className=\"absolute right-0.5 bottom-0.5 text-[9px] font-medium text-muted-foreground/70\">\n            {String.fromCharCode(97 + col)}\n          </span>\n        )}\n      </button>\n    );\n  };\n\n  return (\n    <div className=\"relative\">\n      <div\n        className=\"grid grid-cols-8 rounded overflow-hidden border-4 border-board-border shadow-xl\"\n        style={{\n          width: \"calc(100vh - 80px)\",\n          height: \"calc(100vh - 80px)\",\n          maxWidth: \"600px\",\n          maxHeight: \"600px\",\n        }}\n      >\n        {rows.map((row) => cols.map((col) => renderSquare(row, col)))}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAMA;AARA;;;;AAsBA,MAAM,gBAAwC;IAC5C,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;IACJ,IAAI;AACN;AAEO,SAAS,WAAW,EACzB,SAAS,EACT,cAAc,EACd,UAAU,EACV,QAAQ,EACR,UAAU,EACV,aAAa,EACb,UAAU,KAAK,EACf,aAAa,KAAK,EAClB,cAAc,GAAG,EACD;IAChB,MAAM,OAAO,UAAU;QAAC;QAAG;QAAG;QAAG;QAAG;QAAG;QAAG;QAAG;KAAE,GAAG;QAAC;QAAG;QAAG;QAAG;QAAG;QAAG;QAAG;QAAG;KAAE;IAC1E,MAAM,OAAO,UAAU;QAAC;QAAG;QAAG;QAAG;QAAG;QAAG;QAAG;QAAG;KAAE,GAAG;QAAC;QAAG;QAAG;QAAG;QAAG;QAAG;QAAG;QAAG;KAAE;IAE1E,MAAM,eAAe,CAAC,KAAa;QACjC,MAAM,SAAS,IAAA,wIAAc,EAAC,KAAK;QACnC,MAAM,QAAQ,IAAA,oIAAU,EAAC,WAAW;QACpC,MAAM,UAAU,CAAC,MAAM,GAAG,IAAI,MAAM;QACpC,MAAM,aAAa,mBAAmB;QACtC,MAAM,cAAc,WAAW,QAAQ,CAAC;QACxC,MAAM,qBACJ,UAAU,SAAS,UAAU,UAAU,OAAO;QAChD,MAAM,iBACJ,YAAY,SAAS,UAAU,YAAY,OAAO;QACpD,MAAM,UACJ,OAAO,SAAS,OAChB,MAAM,KAAK,KAAK,UAAU,IAAI,IAC9B,UAAU,OAAO;QACnB,MAAM,WAAW,UAAU;QAC3B,MAAM,gBAAgB,OAAO,UAAU;QACvC,MAAM,eAAe,UAAU,IAAI,KAAK;QAExC,qBACE,8OAAC;YAEC,SAAS,IAAM,cAAc;YAC7B,UAAU;YACV,WAAW,IAAA,kHAAE,EACX,0EACA,gDACA,UAAU,mBAAmB,iBAC7B,WAAW,gBACX,cAAc,kCACd,sBAAsB,oBACtB,kBAAkB,CAAC,sBAAsB,kBACzC,WAAW,sBACX,cAAc,iCACd,CAAC,cACC,iBACA,gBACA,CAAC,cACD;;gBAGH,6BACC,8OAAC;oBACC,WAAW,IAAA,kHAAE,EACX,0DACA,WAAW,sCAAsC;8BAGlD,CAAC,0BACA,8OAAC;wBAAI,WAAU;;;;;;;;;;;gBAKpB,uBACC,8OAAC;oBACC,WAAW,IAAA,kHAAE,EACX,gEACA,MAAM,KAAK,KAAK,MACZ,2DACA,iBACJ,cAAc;8BAGf,aAAa,CAAC,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC;;;;;;gBAI3C,QAAQ,CAAC,UAAU,IAAI,CAAC,mBACvB,8OAAC;oBAAK,WAAU;8BACb,IAAI;;;;;;gBAGR,QAAQ,CAAC,UAAU,IAAI,CAAC,mBACvB,8OAAC;oBAAK,WAAU;8BACb,OAAO,YAAY,CAAC,KAAK;;;;;;;WAtDzB;;;;;IA2DX;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YACC,WAAU;YACV,OAAO;gBACL,OAAO;gBACP,QAAQ;gBACR,UAAU;gBACV,WAAW;YACb;sBAEC,KAAK,GAAG,CAAC,CAAC,MAAQ,KAAK,GAAG,CAAC,CAAC,MAAQ,aAAa,KAAK;;;;;;;;;;;AAI/D"}},
    {"offset": {"line": 1132, "column": 0}, "map": {"version":3,"sources":["file:///home/rajunew/aa/decchessd/components/ui/card.tsx"],"sourcesContent":["import * as React from 'react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Card({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        'bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        '@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn('leading-none font-semibold', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn('text-muted-foreground text-sm', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        'col-start-2 row-span-2 row-start-1 self-start justify-self-end',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn('px-6', className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn('flex items-center px-6 [.border-t]:pt-6', className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 1234, "column": 0}, "map": {"version":3,"sources":["file:///home/rajunew/aa/decchessd/components/ui/badge.tsx"],"sourcesContent":["import * as React from 'react'\nimport { Slot } from '@radix-ui/react-slot'\nimport { cva, type VariantProps } from 'class-variance-authority'\n\nimport { cn } from '@/lib/utils'\n\nconst badgeVariants = cva(\n  'inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden',\n  {\n    variants: {\n      variant: {\n        default:\n          'border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90',\n        secondary:\n          'border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90',\n        destructive:\n          'border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\n        outline:\n          'text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n    },\n  },\n)\n\nfunction Badge({\n  className,\n  variant,\n  asChild = false,\n  ...props\n}: React.ComponentProps<'span'> &\n  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : 'span'\n\n  return (\n    <Comp\n      data-slot=\"badge\"\n      className={cn(badgeVariants({ variant }), className)}\n      {...props}\n    />\n  )\n}\n\nexport { Badge, badgeVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,gBAAgB,IAAA,uKAAG,EACvB,kZACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SACE;QACJ;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAGF,SAAS,MAAM,EACb,SAAS,EACT,OAAO,EACP,UAAU,KAAK,EACf,GAAG,OAEuD;IAC1D,MAAM,OAAO,UAAU,wKAAI,GAAG;IAE9B,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QACzC,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 1280, "column": 0}, "map": {"version":3,"sources":["file:///home/rajunew/aa/decchessd/components/move-history-panel.tsx"],"sourcesContent":["\"use client\"\n\nimport { useMemo } from \"react\"\nimport type { GameState } from \"@/lib/chess-engine\"\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\"\nimport { Badge } from \"@/components/ui/badge\"\n\ntype MoveHistoryPanelProps = {\n  moveNotations: string[]\n  gameState: GameState\n  isThinking: boolean\n}\n\nexport function MoveHistoryPanel({ moveNotations, gameState, isThinking }: MoveHistoryPanelProps) {\n  const pairs = useMemo(() => {\n    const result: string[][] = []\n    for (let i = 0; i < moveNotations.length; i += 2) {\n      result.push([moveNotations[i], moveNotations[i + 1]])\n    }\n    return result\n  }, [moveNotations])\n\n  const status = useMemo(() => {\n    if (gameState.isCheckmate) {\n      const winner = gameState.turn === \"w\" ? \"Black\" : \"White\"\n      return { text: `Checkmate! ${winner} wins`, color: \"text-yellow-500\" }\n    }\n    if (gameState.isStalemate) return { text: \"Stalemate\", color: \"text-muted-foreground\" }\n    if (gameState.isDraw) return { text: \"Draw\", color: \"text-muted-foreground\" }\n    if (gameState.isCheck) return { text: \"Check!\", color: \"text-red-500\" }\n    return null\n  }, [gameState.isCheckmate, gameState.isStalemate, gameState.isDraw, gameState.isCheck, gameState.turn])\n\n  return (\n    <Card className=\"bg-card border-border h-full flex flex-col\">\n      <CardHeader className=\"py-1.5 px-2 flex-shrink-0\">\n        <div className=\"flex items-center justify-between\">\n          <CardTitle className=\"text-xs font-medium\">Move History</CardTitle>\n          <Badge variant=\"outline\" className=\"text-[9px] px-1 py-0 h-4 font-mono\">\n            {gameState.turn === \"w\" ? \"White\" : \"Black\"}\n          </Badge>\n        </div>\n      </CardHeader>\n      <CardContent className=\"px-2 pb-2 flex-1 min-h-0 overflow-hidden\">\n        {status && (\n          <div className={`flex items-center gap-1 mb-1.5 p-1 bg-secondary/50 rounded text-[11px] ${status.color}`}>\n            <span className=\"font-medium\">{status.text}</span>\n          </div>\n        )}\n\n        <div className=\"h-full overflow-y-auto\">\n          {pairs.length === 0 ? (\n            <p className=\"text-[11px] text-muted-foreground text-center py-3\">No moves yet</p>\n          ) : (\n            <div className=\"space-y-px\">\n              {pairs.map((pair, index) => (\n                <div\n                  key={index}\n                  className=\"flex items-center text-[11px] font-mono py-0.5 hover:bg-secondary/30 rounded px-1\"\n                >\n                  <span className=\"w-5 text-muted-foreground\">{index + 1}.</span>\n                  <span className=\"w-12 text-foreground\">{pair[0]}</span>\n                  <span className=\"w-12 text-foreground\">{pair[1] || \"\"}</span>\n                </div>\n              ))}\n              {isThinking && moveNotations.length % 2 === 0 && (\n                <div className=\"flex items-center text-[11px] font-mono py-0.5 px-1\">\n                  <span className=\"w-5 text-muted-foreground\">{pairs.length + 1}.</span>\n                  <span className=\"w-12 text-muted-foreground animate-pulse\">...</span>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      </CardContent>\n    </Card>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AAEA;AACA;AALA;;;;;AAaO,SAAS,iBAAiB,EAAE,aAAa,EAAE,SAAS,EAAE,UAAU,EAAyB;IAC9F,MAAM,QAAQ,IAAA,gNAAO,EAAC;QACpB,MAAM,SAAqB,EAAE;QAC7B,IAAK,IAAI,IAAI,GAAG,IAAI,cAAc,MAAM,EAAE,KAAK,EAAG;YAChD,OAAO,IAAI,CAAC;gBAAC,aAAa,CAAC,EAAE;gBAAE,aAAa,CAAC,IAAI,EAAE;aAAC;QACtD;QACA,OAAO;IACT,GAAG;QAAC;KAAc;IAElB,MAAM,SAAS,IAAA,gNAAO,EAAC;QACrB,IAAI,UAAU,WAAW,EAAE;YACzB,MAAM,SAAS,UAAU,IAAI,KAAK,MAAM,UAAU;YAClD,OAAO;gBAAE,MAAM,CAAC,WAAW,EAAE,OAAO,KAAK,CAAC;gBAAE,OAAO;YAAkB;QACvE;QACA,IAAI,UAAU,WAAW,EAAE,OAAO;YAAE,MAAM;YAAa,OAAO;QAAwB;QACtF,IAAI,UAAU,MAAM,EAAE,OAAO;YAAE,MAAM;YAAQ,OAAO;QAAwB;QAC5E,IAAI,UAAU,OAAO,EAAE,OAAO;YAAE,MAAM;YAAU,OAAO;QAAe;QACtE,OAAO;IACT,GAAG;QAAC,UAAU,WAAW;QAAE,UAAU,WAAW;QAAE,UAAU,MAAM;QAAE,UAAU,OAAO;QAAE,UAAU,IAAI;KAAC;IAEtG,qBACE,8OAAC,iIAAI;QAAC,WAAU;;0BACd,8OAAC,uIAAU;gBAAC,WAAU;0BACpB,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC,sIAAS;4BAAC,WAAU;sCAAsB;;;;;;sCAC3C,8OAAC,mIAAK;4BAAC,SAAQ;4BAAU,WAAU;sCAChC,UAAU,IAAI,KAAK,MAAM,UAAU;;;;;;;;;;;;;;;;;0BAI1C,8OAAC,wIAAW;gBAAC,WAAU;;oBACpB,wBACC,8OAAC;wBAAI,WAAW,CAAC,uEAAuE,EAAE,OAAO,KAAK,EAAE;kCACtG,cAAA,8OAAC;4BAAK,WAAU;sCAAe,OAAO,IAAI;;;;;;;;;;;kCAI9C,8OAAC;wBAAI,WAAU;kCACZ,MAAM,MAAM,KAAK,kBAChB,8OAAC;4BAAE,WAAU;sCAAqD;;;;;iDAElE,8OAAC;4BAAI,WAAU;;gCACZ,MAAM,GAAG,CAAC,CAAC,MAAM,sBAChB,8OAAC;wCAEC,WAAU;;0DAEV,8OAAC;gDAAK,WAAU;;oDAA6B,QAAQ;oDAAE;;;;;;;0DACvD,8OAAC;gDAAK,WAAU;0DAAwB,IAAI,CAAC,EAAE;;;;;;0DAC/C,8OAAC;gDAAK,WAAU;0DAAwB,IAAI,CAAC,EAAE,IAAI;;;;;;;uCAL9C;;;;;gCAQR,cAAc,cAAc,MAAM,GAAG,MAAM,mBAC1C,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAK,WAAU;;gDAA6B,MAAM,MAAM,GAAG;gDAAE;;;;;;;sDAC9D,8OAAC;4CAAK,WAAU;sDAA2C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAS7E"}},
    {"offset": {"line": 1492, "column": 0}, "map": {"version":3,"sources":["file:///home/rajunew/aa/decchessd/components/ai-feedback.tsx"],"sourcesContent":["\"use client\";\n\nimport type { MoveEvaluation } from \"@/lib/adaptive-ai\";\nimport type { PlayerStats } from \"@/lib/adaptive-ai\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\n\ntype AIFeedbackProps = {\n  evaluation: MoveEvaluation | null;\n  analysis: string;\n  isAnalyzing: boolean;\n  isThinking: boolean;\n  playerStats: PlayerStats | null;\n  aiElo: number;\n  difficulty: number;\n};\n\nconst EVALUATION_CONFIG = {\n  brilliant: { label: \"Brilliant!\", color: \"bg-cyan-500 text-white\" },\n  excellent: { label: \"Excellent\", color: \"bg-green-500 text-white\" },\n  good: { label: \"Good\", color: \"bg-emerald-600 text-white\" },\n  inaccuracy: { label: \"Inaccuracy\", color: \"bg-yellow-500 text-black\" },\n  mistake: { label: \"Mistake\", color: \"bg-orange-500 text-white\" },\n  blunder: { label: \"Blunder\", color: \"bg-red-500 text-white\" },\n};\n\nexport function AIFeedback({\n  evaluation,\n  analysis,\n  isAnalyzing,\n  isThinking,\n  playerStats,\n  aiElo,\n  difficulty,\n}: AIFeedbackProps) {\n  return (\n    <Card className=\"bg-card border-border\">\n      <CardContent className=\"p-2 space-y-2\">\n        {playerStats && (\n          <div className=\"flex items-center justify-between text-[11px] border-b border-border pb-1.5\">\n            <span className=\"text-muted-foreground\">\n              You:{\" \"}\n              <span className=\"font-mono font-bold text-primary\">\n                {playerStats.skillRating}\n              </span>\n            </span>\n            <span className=\"text-muted-foreground\">\n              AI: <span className=\"font-mono\">~{aiElo}</span>\n            </span>\n            <Badge variant=\"outline\" className=\"text-[10px] px-1 py-0 h-4\">\n              Lv.{difficulty}\n            </Badge>\n          </div>\n        )}\n\n        {isThinking ? (\n          <div className=\"flex items-center gap-2 py-1\">\n            <div className=\"w-2 h-2 bg-primary rounded-full animate-pulse\" />\n            <span className=\"text-xs text-muted-foreground\">\n              AI considering move...\n            </span>\n          </div>\n        ) : !evaluation ? (\n          <p className=\"text-xs text-muted-foreground py-1\">\n            Make a move for feedback\n          </p>\n        ) : (\n          <>\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-1.5\">\n                <Badge\n                  className={\n                    EVALUATION_CONFIG[evaluation.type].color +\n                    \" text-[10px] px-1.5 h-5\"\n                  }\n                >\n                  {EVALUATION_CONFIG[evaluation.type].label}\n                </Badge>\n                {evaluation.centipawnLoss > 0 && (\n                  <span className=\"text-[15px] text-muted-foreground font-mono\">\n                    -{evaluation.centipawnLoss}cp\n                  </span>\n                )}\n              </div>\n              <span className=\"text-[15px] text-muted-foreground font-mono\">\n                {evaluation.from}-{evaluation.to}\n              </span>\n            </div>\n\n            {evaluation.bestMove && (\n              <p className=\"text-[11px] text-muted-foreground\">\n                Better:{\" \"}\n                <span className=\"font-mono text-foreground\">\n                  {evaluation.bestMove.from}-{evaluation.bestMove.to}\n                </span>\n              </p>\n            )}\n\n            {isAnalyzing ? (\n              <div className=\"flex items-center gap-1.5 text-[15px] text-muted-foreground\">\n                <div className=\"w-1.5 h-1.5 bg-primary rounded-full animate-spin\" />\n                <span>Analyzing...</span>\n              </div>\n            ) : analysis ? (\n              <div className=\"p-1.5 bg-secondary/50 rounded text-[15px] text-foreground leading-relaxed max-h-20 overflow-y-auto\">\n                {analysis}\n              </div>\n            ) : null}\n          </>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n"],"names":[],"mappings":";;;;;AAIA;AACA;AALA;;;;AAiBA,MAAM,oBAAoB;IACxB,WAAW;QAAE,OAAO;QAAc,OAAO;IAAyB;IAClE,WAAW;QAAE,OAAO;QAAa,OAAO;IAA0B;IAClE,MAAM;QAAE,OAAO;QAAQ,OAAO;IAA4B;IAC1D,YAAY;QAAE,OAAO;QAAc,OAAO;IAA2B;IACrE,SAAS;QAAE,OAAO;QAAW,OAAO;IAA2B;IAC/D,SAAS;QAAE,OAAO;QAAW,OAAO;IAAwB;AAC9D;AAEO,SAAS,WAAW,EACzB,UAAU,EACV,QAAQ,EACR,WAAW,EACX,UAAU,EACV,WAAW,EACX,KAAK,EACL,UAAU,EACM;IAChB,qBACE,8OAAC,iIAAI;QAAC,WAAU;kBACd,cAAA,8OAAC,wIAAW;YAAC,WAAU;;gBACpB,6BACC,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAK,WAAU;;gCAAwB;gCACjC;8CACL,8OAAC;oCAAK,WAAU;8CACb,YAAY,WAAW;;;;;;;;;;;;sCAG5B,8OAAC;4BAAK,WAAU;;gCAAwB;8CAClC,8OAAC;oCAAK,WAAU;;wCAAY;wCAAE;;;;;;;;;;;;;sCAEpC,8OAAC,mIAAK;4BAAC,SAAQ;4BAAU,WAAU;;gCAA4B;gCACzD;;;;;;;;;;;;;gBAKT,2BACC,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;;;;;;sCACf,8OAAC;4BAAK,WAAU;sCAAgC;;;;;;;;;;;2BAIhD,CAAC,2BACH,8OAAC;oBAAE,WAAU;8BAAqC;;;;;yCAIlD;;sCACE,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAI,WAAU;;sDACb,8OAAC,mIAAK;4CACJ,WACE,iBAAiB,CAAC,WAAW,IAAI,CAAC,CAAC,KAAK,GACxC;sDAGD,iBAAiB,CAAC,WAAW,IAAI,CAAC,CAAC,KAAK;;;;;;wCAE1C,WAAW,aAAa,GAAG,mBAC1B,8OAAC;4CAAK,WAAU;;gDAA8C;gDAC1D,WAAW,aAAa;gDAAC;;;;;;;;;;;;;8CAIjC,8OAAC;oCAAK,WAAU;;wCACb,WAAW,IAAI;wCAAC;wCAAE,WAAW,EAAE;;;;;;;;;;;;;wBAInC,WAAW,QAAQ,kBAClB,8OAAC;4BAAE,WAAU;;gCAAoC;gCACvC;8CACR,8OAAC;oCAAK,WAAU;;wCACb,WAAW,QAAQ,CAAC,IAAI;wCAAC;wCAAE,WAAW,QAAQ,CAAC,EAAE;;;;;;;;;;;;;wBAKvD,4BACC,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAI,WAAU;;;;;;8CACf,8OAAC;8CAAK;;;;;;;;;;;mCAEN,yBACF,8OAAC;4BAAI,WAAU;sCACZ;;;;;mCAED;;;;;;;;;;;;;;AAMhB"}},
    {"offset": {"line": 1749, "column": 0}, "map": {"version":3,"sources":["file:///home/rajunew/aa/decchessd/components/ui/dialog.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as DialogPrimitive from '@radix-ui/react-dialog'\nimport { XIcon } from 'lucide-react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Dialog({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Root>) {\n  return <DialogPrimitive.Root data-slot=\"dialog\" {...props} />\n}\n\nfunction DialogTrigger({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Trigger>) {\n  return <DialogPrimitive.Trigger data-slot=\"dialog-trigger\" {...props} />\n}\n\nfunction DialogPortal({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Portal>) {\n  return <DialogPrimitive.Portal data-slot=\"dialog-portal\" {...props} />\n}\n\nfunction DialogClose({\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Close>) {\n  return <DialogPrimitive.Close data-slot=\"dialog-close\" {...props} />\n}\n\nfunction DialogOverlay({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Overlay>) {\n  return (\n    <DialogPrimitive.Overlay\n      data-slot=\"dialog-overlay\"\n      className={cn(\n        'data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DialogContent({\n  className,\n  children,\n  showCloseButton = true,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Content> & {\n  showCloseButton?: boolean\n}) {\n  return (\n    <DialogPortal data-slot=\"dialog-portal\">\n      <DialogOverlay />\n      <DialogPrimitive.Content\n        data-slot=\"dialog-content\"\n        className={cn(\n          'bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg',\n          className,\n        )}\n        {...props}\n      >\n        {children}\n        {showCloseButton && (\n          <DialogPrimitive.Close\n            data-slot=\"dialog-close\"\n            className=\"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\"\n          >\n            <XIcon />\n            <span className=\"sr-only\">Close</span>\n          </DialogPrimitive.Close>\n        )}\n      </DialogPrimitive.Content>\n    </DialogPortal>\n  )\n}\n\nfunction DialogHeader({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"dialog-header\"\n      className={cn('flex flex-col gap-2 text-center sm:text-left', className)}\n      {...props}\n    />\n  )\n}\n\nfunction DialogFooter({ className, ...props }: React.ComponentProps<'div'>) {\n  return (\n    <div\n      data-slot=\"dialog-footer\"\n      className={cn(\n        'flex flex-col-reverse gap-2 sm:flex-row sm:justify-end',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction DialogTitle({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Title>) {\n  return (\n    <DialogPrimitive.Title\n      data-slot=\"dialog-title\"\n      className={cn('text-lg leading-none font-semibold', className)}\n      {...props}\n    />\n  )\n}\n\nfunction DialogDescription({\n  className,\n  ...props\n}: React.ComponentProps<typeof DialogPrimitive.Description>) {\n  return (\n    <DialogPrimitive.Description\n      data-slot=\"dialog-description\"\n      className={cn('text-muted-foreground text-sm', className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Dialog,\n  DialogClose,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogOverlay,\n  DialogPortal,\n  DialogTitle,\n  DialogTrigger,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAGA;AACA;AAEA;AANA;;;;;AAQA,SAAS,OAAO,EACd,GAAG,OAC+C;IAClD,qBAAO,8OAAC,0KAAoB;QAAC,aAAU;QAAU,GAAG,KAAK;;;;;;AAC3D;AAEA,SAAS,cAAc,EACrB,GAAG,OACkD;IACrD,qBAAO,8OAAC,6KAAuB;QAAC,aAAU;QAAkB,GAAG,KAAK;;;;;;AACtE;AAEA,SAAS,aAAa,EACpB,GAAG,OACiD;IACpD,qBAAO,8OAAC,4KAAsB;QAAC,aAAU;QAAiB,GAAG,KAAK;;;;;;AACpE;AAEA,SAAS,YAAY,EACnB,GAAG,OACgD;IACnD,qBAAO,8OAAC,2KAAqB;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AAClE;AAEA,SAAS,cAAc,EACrB,SAAS,EACT,GAAG,OACkD;IACrD,qBACE,8OAAC,6KAAuB;QACtB,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,0JACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,cAAc,EACrB,SAAS,EACT,QAAQ,EACR,kBAAkB,IAAI,EACtB,GAAG,OAGJ;IACC,qBACE,8OAAC;QAAa,aAAU;;0BACtB,8OAAC;;;;;0BACD,8OAAC,6KAAuB;gBACtB,aAAU;gBACV,WAAW,IAAA,kHAAE,EACX,+WACA;gBAED,GAAG,KAAK;;oBAER;oBACA,iCACC,8OAAC,2KAAqB;wBACpB,aAAU;wBACV,WAAU;;0CAEV,8OAAC,yMAAK;;;;;0CACN,8OAAC;gCAAK,WAAU;0CAAU;;;;;;;;;;;;;;;;;;;;;;;;AAMtC;AAEA,SAAS,aAAa,EAAE,SAAS,EAAE,GAAG,OAAoC;IACxE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,gDAAgD;QAC7D,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,aAAa,EAAE,SAAS,EAAE,GAAG,OAAoC;IACxE,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,0DACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,8OAAC,2KAAqB;QACpB,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,sCAAsC;QACnD,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,kBAAkB,EACzB,SAAS,EACT,GAAG,OACsD;IACzD,qBACE,8OAAC,iLAA2B;QAC1B,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 1931, "column": 0}, "map": {"version":3,"sources":["file:///home/rajunew/aa/decchessd/components/ui/button.tsx"],"sourcesContent":["import * as React from 'react'\nimport { Slot } from '@radix-ui/react-slot'\nimport { cva, type VariantProps } from 'class-variance-authority'\n\nimport { cn } from '@/lib/utils'\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default: 'bg-primary text-primary-foreground hover:bg-primary/90',\n        destructive:\n          'bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\n        outline:\n          'border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50',\n        secondary:\n          'bg-secondary text-secondary-foreground hover:bg-secondary/80',\n        ghost:\n          'hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50',\n        link: 'text-primary underline-offset-4 hover:underline',\n      },\n      size: {\n        default: 'h-9 px-4 py-2 has-[>svg]:px-3',\n        sm: 'h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5',\n        lg: 'h-10 rounded-md px-6 has-[>svg]:px-4',\n        icon: 'size-9',\n        'icon-sm': 'size-8',\n        'icon-lg': 'size-10',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n      size: 'default',\n    },\n  },\n)\n\nfunction Button({\n  className,\n  variant,\n  size,\n  asChild = false,\n  ...props\n}: React.ComponentProps<'button'> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : 'button'\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,uKAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,wKAAI,GAAG;IAE9B,qBACE,8OAAC;QACC,aAAU;QACV,WAAW,IAAA,kHAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 1990, "column": 0}, "map": {"version":3,"sources":["file:///home/rajunew/aa/decchessd/components/ui/input.tsx"],"sourcesContent":["import * as React from 'react'\n\nimport { cn } from '@/lib/utils'\n\nfunction Input({ className, type, ...props }: React.ComponentProps<'input'>) {\n  return (\n    <input\n      type={type}\n      data-slot=\"input\"\n      className={cn(\n        'file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm',\n        'focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]',\n        'aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Input }\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,MAAM,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAsC;IACzE,qBACE,8OAAC;QACC,MAAM;QACN,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,8bACA,iFACA,0GACA;QAED,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 2015, "column": 0}, "map": {"version":3,"sources":["file:///home/rajunew/aa/decchessd/components/ui/label.tsx"],"sourcesContent":["'use client'\n\nimport * as React from 'react'\nimport * as LabelPrimitive from '@radix-ui/react-label'\n\nimport { cn } from '@/lib/utils'\n\nfunction Label({\n  className,\n  ...props\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\n  return (\n    <LabelPrimitive.Root\n      data-slot=\"label\"\n      className={cn(\n        'flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50',\n        className,\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Label }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,MAAM,EACb,SAAS,EACT,GAAG,OAC8C;IACjD,qBACE,8OAAC,yKAAmB;QAClB,aAAU;QACV,WAAW,IAAA,kHAAE,EACX,uNACA;QAED,GAAG,KAAK;;;;;;AAGf"}},
    {"offset": {"line": 2042, "column": 0}, "map": {"version":3,"sources":["file:///home/rajunew/aa/decchessd/components/game-setup-modal.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState } from \"react\"\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Label } from \"@/components/ui/label\"\nimport { Crown, Play } from \"lucide-react\"\nimport { cn } from \"@/lib/utils\"\n\ntype GameSetupModalProps = {\n  open: boolean\n  onStartGame: (color: \"w\" | \"b\", initialElo: number) => void\n  onClose?: () => void // Added close handler\n  isFirstGame: boolean\n  currentElo: number\n}\n\nconst ELO_PRESETS = [\n  { value: 400, label: \"Complete Beginner\", description: \"Just learning the rules\" },\n  { value: 800, label: \"Casual Player\", description: \"Know basics, play occasionally\" },\n  { value: 1000, label: \"Club Player\", description: \"Regular player, understand tactics\" },\n  { value: 1200, label: \"Intermediate\", description: \"Solid fundamentals\" },\n  { value: 1500, label: \"Advanced\", description: \"Strong tactical and positional play\" },\n  { value: 1800, label: \"Expert\", description: \"Tournament level player\" },\n  { value: 2000, label: \"Master\", description: \"Highly skilled player\" },\n]\n\nexport function GameSetupModal({ open, onStartGame, onClose, isFirstGame, currentElo }: GameSetupModalProps) {\n  const [selectedColor, setSelectedColor] = useState<\"w\" | \"b\">(\"w\")\n  const [eloInput, setEloInput] = useState<string>(isFirstGame ? \"1000\" : currentElo.toString())\n  const [selectedPreset, setSelectedPreset] = useState<number | null>(isFirstGame ? 1000 : null)\n\n  const handlePresetClick = (value: number) => {\n    setSelectedPreset(value)\n    setEloInput(value.toString())\n  }\n\n  const handleStart = () => {\n    const elo = Math.max(100, Math.min(3000, Number.parseInt(eloInput) || 1000))\n    onStartGame(selectedColor, elo)\n  }\n\n  const handleClose = () => {\n    if (!isFirstGame && onClose) {\n      onClose()\n    }\n  }\n\n  return (\n    <Dialog open={open} onOpenChange={(isOpen) => !isOpen && handleClose()}>\n      <DialogContent className=\"sm:max-w-lg bg-card border-border\" showCloseButton={!isFirstGame}>\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2 text-xl\">\n            <Crown className=\"w-5 h-5 text-primary\" />\n            {isFirstGame ? \"Welcome to ChessMind AI!\" : \"New Game Setup\"}\n          </DialogTitle>\n          <DialogDescription>\n            {isFirstGame\n              ? \"Set up your profile to get started with adaptive AI training.\"\n              : \"Configure your next game against the adaptive AI.\"}\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-6 py-4\">\n          {/* Color Selection */}\n          <div className=\"space-y-3\">\n            <Label className=\"text-base font-semibold\">Choose Your Color</Label>\n            <div className=\"grid grid-cols-2 gap-3\">\n              <button\n                type=\"button\"\n                onClick={() => setSelectedColor(\"w\")}\n                className={cn(\n                  \"p-4 rounded-lg border-2 transition-all flex flex-col items-center gap-2\",\n                  selectedColor === \"w\"\n                    ? \"border-primary bg-primary/10\"\n                    : \"border-border hover:border-primary/50 bg-secondary/30\",\n                )}\n              >\n                <div className=\"w-12 h-12 rounded-full bg-white border-2 border-gray-300 flex items-center justify-center text-3xl shadow-md\">\n                  ♔\n                </div>\n                <span className=\"font-medium text-foreground\">Play as White</span>\n                <span className=\"text-xs text-muted-foreground\">Move first</span>\n              </button>\n              <button\n                type=\"button\"\n                onClick={() => setSelectedColor(\"b\")}\n                className={cn(\n                  \"p-4 rounded-lg border-2 transition-all flex flex-col items-center gap-2\",\n                  selectedColor === \"b\"\n                    ? \"border-primary bg-primary/10\"\n                    : \"border-border hover:border-primary/50 bg-secondary/30\",\n                )}\n              >\n                <div className=\"w-12 h-12 rounded-full bg-gray-900 border-2 border-gray-700 flex items-center justify-center text-3xl shadow-md\">\n                  <span className=\"text-white\">♚</span>\n                </div>\n                <span className=\"font-medium text-foreground\">Play as Black</span>\n                <span className=\"text-xs text-muted-foreground\">Respond to White</span>\n              </button>\n            </div>\n          </div>\n\n          {/* ELO Selection - Only for first game */}\n          {isFirstGame && (\n            <div className=\"space-y-3\">\n              <Label className=\"text-base font-semibold\">What's Your Skill Level?</Label>\n              <p className=\"text-sm text-muted-foreground\">\n                Select your approximate ELO rating. The AI will adapt to your skill level.\n              </p>\n\n              <div className=\"grid grid-cols-2 gap-2 max-h-[200px] overflow-y-auto pr-1\">\n                {ELO_PRESETS.map((preset) => (\n                  <button\n                    key={preset.value}\n                    type=\"button\"\n                    onClick={() => handlePresetClick(preset.value)}\n                    className={cn(\n                      \"p-3 rounded-lg border text-left transition-all\",\n                      selectedPreset === preset.value\n                        ? \"border-primary bg-primary/10\"\n                        : \"border-border hover:border-primary/50 bg-secondary/30\",\n                    )}\n                  >\n                    <div className=\"flex justify-between items-center\">\n                      <span className=\"font-medium text-sm text-foreground\">{preset.label}</span>\n                      <span className=\"text-xs font-mono text-primary\">{preset.value}</span>\n                    </div>\n                    <p className=\"text-xs text-muted-foreground mt-1\">{preset.description}</p>\n                  </button>\n                ))}\n              </div>\n\n              <div className=\"flex items-center gap-3 pt-2\">\n                <Label htmlFor=\"custom-elo\" className=\"text-sm whitespace-nowrap\">\n                  Or enter custom ELO:\n                </Label>\n                <Input\n                  id=\"custom-elo\"\n                  type=\"number\"\n                  min={100}\n                  max={3000}\n                  value={eloInput}\n                  onChange={(e) => {\n                    setEloInput(e.target.value)\n                    setSelectedPreset(null)\n                  }}\n                  className=\"w-24 font-mono\"\n                />\n              </div>\n            </div>\n          )}\n\n          {/* Current ELO display for returning players */}\n          {!isFirstGame && (\n            <div className=\"p-4 rounded-lg bg-secondary/50 border border-border\">\n              <div className=\"flex justify-between items-center\">\n                <span className=\"text-sm text-muted-foreground\">Your Current ELO</span>\n                <span className=\"text-2xl font-bold font-mono text-primary\">{currentElo}</span>\n              </div>\n              <p className=\"text-xs text-muted-foreground mt-2\">\n                The AI will match your skill level and adapt as you play.\n              </p>\n            </div>\n          )}\n\n          <Button onClick={handleStart} className=\"w-full\" size=\"lg\">\n            <Play className=\"w-4 h-4 mr-2\" />\n            Start Game\n          </Button>\n        </div>\n      </DialogContent>\n    </Dialog>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2456, "column": 0}, "map": {"version":3,"sources":["file:///home/rajunew/aa/decchessd/lib/stockfish-eval.ts"],"sourcesContent":["import type { PlayerStats, MoveEvaluation } from \"./adaptive-ai\"\n\n// Stockfish 17 centipawn evaluation thresholds\nexport const STOCKFISH_THRESHOLDS = {\n  BRILLIANT: -200, // Player found a move better than expected\n  EXCELLENT: -50, // Very close to best move\n  GOOD: 0, // Acceptable move\n  INACCURACY: 50, // Small mistake (0.5 pawns)\n  MISTAKE: 150, // Medium mistake (1.5 pawns)\n  BLUNDER: 300, // Big mistake (3+ pawns)\n}\n\nexport const STOCKFISH_LEVELS: Record<\n  number,\n  { elo: number; depth: number; errorRate: number; blunderRate: number; skillLevel: number }\n> = {\n  1: { elo: 400, depth: 1, errorRate: 0.4, blunderRate: 0.15, skillLevel: 0 },\n  2: { elo: 600, depth: 2, errorRate: 0.35, blunderRate: 0.12, skillLevel: 2 },\n  3: { elo: 800, depth: 3, errorRate: 0.3, blunderRate: 0.1, skillLevel: 4 },\n  4: { elo: 1000, depth: 4, errorRate: 0.25, blunderRate: 0.08, skillLevel: 6 },\n  5: { elo: 1200, depth: 5, errorRate: 0.2, blunderRate: 0.06, skillLevel: 8 },\n  6: { elo: 1400, depth: 6, errorRate: 0.15, blunderRate: 0.04, skillLevel: 10 },\n  7: { elo: 1600, depth: 8, errorRate: 0.1, blunderRate: 0.02, skillLevel: 12 },\n  8: { elo: 1800, depth: 10, errorRate: 0.05, blunderRate: 0.01, skillLevel: 15 },\n  9: { elo: 2000, depth: 12, errorRate: 0.02, blunderRate: 0.005, skillLevel: 18 },\n  10: { elo: 2200, depth: 15, errorRate: 0.01, blunderRate: 0.002, skillLevel: 20 },\n}\n\n// Convert player ELO to AI difficulty level\nexport function eloToDifficulty(playerElo: number): number {\n  if (playerElo <= 500) return 1\n  if (playerElo <= 700) return 2\n  if (playerElo <= 900) return 3\n  if (playerElo <= 1100) return 4\n  if (playerElo <= 1300) return 5\n  if (playerElo <= 1500) return 6\n  if (playerElo <= 1700) return 7\n  if (playerElo <= 1900) return 8\n  if (playerElo <= 2100) return 9\n  return 10\n}\n\n// Calculate ELO change after a game (standard ELO formula)\nexport function calculateEloChange(playerElo: number, opponentElo: number, result: \"win\" | \"loss\" | \"draw\"): number {\n  // K-factor based on rating\n  const K = playerElo < 1000 ? 40 : playerElo < 1400 ? 32 : playerElo < 2000 ? 24 : 16\n\n  // Expected score\n  const expectedScore = 1 / (1 + Math.pow(10, (opponentElo - playerElo) / 400))\n\n  // Actual score\n  const actualScore = result === \"win\" ? 1 : result === \"draw\" ? 0.5 : 0\n\n  // ELO change\n  return Math.round(K * (actualScore - expectedScore))\n}\n\n// Calculate accuracy percentage from move evaluations (Stockfish-style)\nexport function calculateAccuracy(evaluations: MoveEvaluation[]): number {\n  if (evaluations.length === 0) return 100\n\n  let totalAccuracy = 0\n  for (const eval_ of evaluations) {\n    switch (eval_.type) {\n      case \"brilliant\":\n        totalAccuracy += 100\n        break\n      case \"excellent\":\n        totalAccuracy += 95\n        break\n      case \"good\":\n        totalAccuracy += 85\n        break\n      case \"inaccuracy\":\n        totalAccuracy += 65\n        break\n      case \"mistake\":\n        totalAccuracy += 40\n        break\n      case \"blunder\":\n        totalAccuracy += 15\n        break\n    }\n  }\n\n  return Math.round(totalAccuracy / evaluations.length)\n}\n\n// Get move grade based on centipawn loss (Stockfish-style)\nexport function getMoveGrade(centipawnLoss: number): MoveEvaluation[\"type\"] {\n  if (centipawnLoss <= STOCKFISH_THRESHOLDS.BRILLIANT) return \"brilliant\"\n  if (centipawnLoss <= STOCKFISH_THRESHOLDS.EXCELLENT) return \"excellent\"\n  if (centipawnLoss <= STOCKFISH_THRESHOLDS.GOOD) return \"good\"\n  if (centipawnLoss <= STOCKFISH_THRESHOLDS.INACCURACY) return \"inaccuracy\"\n  if (centipawnLoss <= STOCKFISH_THRESHOLDS.MISTAKE) return \"mistake\"\n  return \"blunder\"\n}\n\n// Adaptive difficulty adjustment based on player performance\nexport function getAdaptiveDifficulty(\n  baseDifficulty: number,\n  stats: PlayerStats,\n  gameEvaluations: MoveEvaluation[],\n): number {\n  let adjustment = 0\n\n  // Recent game accuracy adjustment\n  const recentAccuracy = calculateAccuracy(gameEvaluations)\n  if (recentAccuracy > 85 && gameEvaluations.length >= 5) {\n    adjustment += 1 // Player is doing very well\n  } else if (recentAccuracy < 50 && gameEvaluations.length >= 5) {\n    adjustment -= 1 // Player is struggling\n  }\n\n  // Win streak adjustment\n  if (stats.currentStreak >= 3) {\n    adjustment += 1\n  } else if (stats.currentStreak <= -3) {\n    adjustment -= 1\n  }\n\n  // Blunder rate adjustment\n  const blunderRate =\n    gameEvaluations.length > 0 ? gameEvaluations.filter((e) => e.type === \"blunder\").length / gameEvaluations.length : 0\n  if (blunderRate > 0.2 && gameEvaluations.length >= 5) {\n    adjustment -= 1 // Too many blunders, ease up\n  }\n\n  // Clamp to valid range\n  return Math.max(1, Math.min(10, baseDifficulty + adjustment))\n}\n\n// Get AI opponent's effective ELO based on difficulty and adaptation\nexport function getAIOpponentElo(difficulty: number, adaptiveBonus = 0): number {\n  const baseElo = STOCKFISH_LEVELS[difficulty]?.elo || 1000\n  return baseElo + adaptiveBonus\n}\n\n// Generate Stockfish-style evaluation bar value (-1 to 1, where positive is white advantage)\nexport function getEvaluationBarValue(centipawns: number): number {\n  // Use a sigmoid-like function to map centipawns to -1 to 1 range\n  const maxAdvantage = 1000 // 10 pawns = fully winning\n  return Math.tanh(centipawns / maxAdvantage)\n}\n\n// Get evaluation description\nexport function getEvaluationDescription(centipawns: number): string {\n  const pawns = centipawns / 100\n  if (Math.abs(pawns) < 0.3) return \"Equal position\"\n  if (Math.abs(pawns) < 1) return `Slight ${pawns > 0 ? \"white\" : \"black\"} advantage`\n  if (Math.abs(pawns) < 2) return `${pawns > 0 ? \"White\" : \"Black\"} is better`\n  if (Math.abs(pawns) < 5) return `${pawns > 0 ? \"White\" : \"Black\"} has a winning advantage`\n  return `${pawns > 0 ? \"White\" : \"Black\"} is winning`\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2660, "column": 0}, "map": {"version":3,"sources":["file:///home/rajunew/aa/decchessd/components/evaluation-bar.tsx"],"sourcesContent":["\"use client\"\n\nimport { cn } from \"@/lib/utils\"\nimport { getEvaluationBarValue } from \"@/lib/stockfish-eval\"\n\ntype EvaluationBarProps = {\n  evaluation: number\n  playerColor: \"w\" | \"b\"\n}\n\nexport function EvaluationBar({ evaluation, playerColor }: EvaluationBarProps) {\n  const barValue = getEvaluationBarValue(evaluation)\n  const percentage = ((barValue + 1) / 2) * 100\n  const displayPercentage = playerColor === \"b\" ? 100 - percentage : percentage\n\n  const displayEval = Math.abs(evaluation / 100).toFixed(1)\n  const isWhiteAdvantage = evaluation > 0\n\n  return (\n    <div className=\"flex flex-col items-center gap-1 h-full w-full\">\n      <div\n        className={cn(\n          \"text-[10px] font-mono font-bold px-1 py-0.5 rounded\",\n          isWhiteAdvantage ? \"bg-eval-white text-background\" : \"bg-eval-black text-foreground\",\n        )}\n      >\n        {isWhiteAdvantage ? \"+\" : \"-\"}\n        {displayEval}\n      </div>\n\n      <div className=\"relative w-full flex-1 bg-eval-black rounded overflow-hidden border border-board-border\">\n        <div\n          className=\"absolute inset-x-0 bottom-0 bg-eval-white transition-all duration-300 ease-out\"\n          style={{ height: `${displayPercentage}%` }}\n        />\n        <div className=\"absolute inset-x-0 top-1/2 h-px bg-primary/60 -translate-y-1/2\" />\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAUO,SAAS,cAAc,EAAE,UAAU,EAAE,WAAW,EAAsB;IAC3E,MAAM,WAAW,IAAA,iJAAqB,EAAC;IACvC,MAAM,aAAa,AAAC,CAAC,WAAW,CAAC,IAAI,IAAK;IAC1C,MAAM,oBAAoB,gBAAgB,MAAM,MAAM,aAAa;IAEnE,MAAM,cAAc,KAAK,GAAG,CAAC,aAAa,KAAK,OAAO,CAAC;IACvD,MAAM,mBAAmB,aAAa;IAEtC,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBACC,WAAW,IAAA,kHAAE,EACX,uDACA,mBAAmB,kCAAkC;;oBAGtD,mBAAmB,MAAM;oBACzB;;;;;;;0BAGH,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,WAAU;wBACV,OAAO;4BAAE,QAAQ,GAAG,kBAAkB,CAAC,CAAC;wBAAC;;;;;;kCAE3C,8OAAC;wBAAI,WAAU;;;;;;;;;;;;;;;;;;AAIvB"}},
    {"offset": {"line": 2728, "column": 0}, "map": {"version":3,"sources":["file:///home/rajunew/aa/decchessd/components/game-controls.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { Button } from \"@/components/ui/button\"\r\nimport { Card, CardContent } from \"@/components/ui/card\"\r\nimport { useState } from \"react\"\r\n\r\ntype GameControlsProps = {\r\n  onUndo: () => void\r\n  onRedo: () => void\r\n  onCopyPGN: () => void\r\n  onNewGame: () => void\r\n  canUndo: boolean\r\n  canRedo: boolean\r\n  gameStarted: boolean\r\n}\r\n\r\nexport function GameControls({\r\n  onUndo,\r\n  onRedo,\r\n  onCopyPGN,\r\n  onNewGame,\r\n  canUndo,\r\n  canRedo,\r\n  gameStarted,\r\n}: GameControlsProps) {\r\n  const [copied, setCopied] = useState(false)\r\n\r\n  const handleCopy = () => {\r\n    onCopyPGN()\r\n    setCopied(true)\r\n    setTimeout(() => setCopied(false), 2000)\r\n  }\r\n\r\n  return (\r\n    <Card className=\"bg-card border-border\">\r\n      <CardContent className=\"p-1.5\">\r\n        <div className=\"flex items-center gap-1\">\r\n          <Button\r\n            variant=\"ghost\"\r\n            size=\"sm\"\r\n            onClick={onUndo}\r\n            disabled={!canUndo}\r\n            className=\"h-7 px-2 text-[11px] flex-1\"\r\n          >\r\n            Undo\r\n          </Button>\r\n          <Button\r\n            variant=\"ghost\"\r\n            size=\"sm\"\r\n            onClick={onRedo}\r\n            disabled={!canRedo}\r\n            className=\"h-7 px-2 text-[11px] flex-1\"\r\n          >\r\n            Redo\r\n          </Button>\r\n          <Button\r\n            variant=\"ghost\"\r\n            size=\"sm\"\r\n            onClick={handleCopy}\r\n            disabled={!gameStarted}\r\n            className=\"h-7 px-2 text-[11px] flex-1\"\r\n          >\r\n            {copied ? \"Copied!\" : \"PGN\"}\r\n          </Button>\r\n          <Button\r\n            variant=\"outline\"\r\n            size=\"sm\"\r\n            onClick={onNewGame}\r\n            className=\"h-7 px-2 text-[11px] flex-1 bg-transparent\"\r\n          >\r\n            New\r\n          </Button>\r\n        </div>\r\n      </CardContent>\r\n    </Card>\r\n  )\r\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAgBO,SAAS,aAAa,EAC3B,MAAM,EACN,MAAM,EACN,SAAS,EACT,SAAS,EACT,OAAO,EACP,OAAO,EACP,WAAW,EACO;IAClB,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAC;IAErC,MAAM,aAAa;QACjB;QACA,UAAU;QACV,WAAW,IAAM,UAAU,QAAQ;IACrC;IAEA,qBACE,8OAAC,iIAAI;QAAC,WAAU;kBACd,cAAA,8OAAC,wIAAW;YAAC,WAAU;sBACrB,cAAA,8OAAC;gBAAI,WAAU;;kCACb,8OAAC,qIAAM;wBACL,SAAQ;wBACR,MAAK;wBACL,SAAS;wBACT,UAAU,CAAC;wBACX,WAAU;kCACX;;;;;;kCAGD,8OAAC,qIAAM;wBACL,SAAQ;wBACR,MAAK;wBACL,SAAS;wBACT,UAAU,CAAC;wBACX,WAAU;kCACX;;;;;;kCAGD,8OAAC,qIAAM;wBACL,SAAQ;wBACR,MAAK;wBACL,SAAS;wBACT,UAAU,CAAC;wBACX,WAAU;kCAET,SAAS,YAAY;;;;;;kCAExB,8OAAC,qIAAM;wBACL,SAAQ;wBACR,MAAK;wBACL,SAAS;wBACT,WAAU;kCACX;;;;;;;;;;;;;;;;;;;;;;AAOX"}},
    {"offset": {"line": 2823, "column": 0}, "map": {"version":3,"sources":["file:///home/rajunew/aa/decchessd/components/blunder-alert.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogDescription,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { AlertTriangle, Undo2, ArrowRight } from \"lucide-react\";\nimport type { MoveEvaluation } from \"@/lib/adaptive-ai\";\n\ntype BlunderAlertProps = {\n  open: boolean;\n  evaluation: MoveEvaluation | null;\n  onUndo: () => void;\n  onDismiss: () => void;\n};\n\nexport function BlunderAlert({\n  open,\n  evaluation,\n  onUndo,\n  onDismiss,\n}: BlunderAlertProps) {\n  if (!evaluation) return null;\n\n  const isBlunder = evaluation.type === \"blunder\";\n  const isMistake = evaluation.type === \"mistake\";\n\n  return (\n    <Dialog open={open} onOpenChange={(isOpen) => !isOpen && onDismiss()}>\n      <DialogContent className=\"sm:max-w-md bg-card border-border\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2 text-xl\">\n            <AlertTriangle\n              className={isBlunder ? \"text-red-500\" : \"text-orange-500\"}\n            />\n            {isBlunder ? \"Blunder Detected!\" : \"Mistake Detected!\"}\n          </DialogTitle>\n          <DialogDescription>\n            {isBlunder\n              ? \"You made a significant error. Let's learn from it!\"\n              : \"That wasn't the best move. Here's what you could do better.\"}\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4 py-4\">\n          <div className=\"p-4 rounded-lg bg-secondary/50 border border-border\">\n            <div className=\"flex items-center gap-2 mb-2\">\n              <span className=\"text-sm font-medium text-muted-foreground\">\n                Your move:\n              </span>\n              <span className=\"font-mono font-bold\">\n                {evaluation.from} → {evaluation.to}\n              </span>\n            </div>\n            <div className=\"text-sm text-red-400\">\n              Centipawn loss: {evaluation.centipawnLoss}cp\n            </div>\n          </div>\n\n          {evaluation.bestMove && (\n            <div className=\"p-4 rounded-lg bg-green-500/10 border border-green-500/30\">\n              <div className=\"flex items-center gap-2 mb-2\">\n                <ArrowRight className=\"w-4 h-4 text-green-500\" />\n                <span className=\"text-sm font-medium text-green-400\">\n                  Best move was:\n                </span>\n              </div>\n              <span className=\"font-mono font-bold text-green-400 text-lg\">\n                {evaluation.bestMove.from} → {evaluation.bestMove.to}\n              </span>\n              <p className=\"text-xs text-muted-foreground mt-2\">\n                Try this move to practice finding the best continuation.\n              </p>\n            </div>\n          )}\n\n          <div className=\"flex gap-3\">\n            <Button onClick={onUndo} className=\"flex-1\" variant=\"default\">\n              <Undo2 className=\"w-4 h-4 mr-2\" />\n              Undo & Try Again\n            </Button>\n            <Button\n              onClick={onDismiss}\n              variant=\"outline\"\n              className=\"flex-1 bg-transparent\"\n            >\n              Continue Anyway\n            </Button>\n          </div>\n        </div>\n      </DialogContent>\n    </Dialog>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAOA;AACA;AAAA;AAAA;AAVA;;;;;AAoBO,SAAS,aAAa,EAC3B,IAAI,EACJ,UAAU,EACV,MAAM,EACN,SAAS,EACS;IAClB,IAAI,CAAC,YAAY,OAAO;IAExB,MAAM,YAAY,WAAW,IAAI,KAAK;IACtC,MAAM,YAAY,WAAW,IAAI,KAAK;IAEtC,qBACE,8OAAC,qIAAM;QAAC,MAAM;QAAM,cAAc,CAAC,SAAW,CAAC,UAAU;kBACvD,cAAA,8OAAC,4IAAa;YAAC,WAAU;;8BACvB,8OAAC,2IAAY;;sCACX,8OAAC,0IAAW;4BAAC,WAAU;;8CACrB,8OAAC,yOAAa;oCACZ,WAAW,YAAY,iBAAiB;;;;;;gCAEzC,YAAY,sBAAsB;;;;;;;sCAErC,8OAAC,gJAAiB;sCACf,YACG,uDACA;;;;;;;;;;;;8BAIR,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAI,WAAU;;sDACb,8OAAC;4CAAK,WAAU;sDAA4C;;;;;;sDAG5D,8OAAC;4CAAK,WAAU;;gDACb,WAAW,IAAI;gDAAC;gDAAI,WAAW,EAAE;;;;;;;;;;;;;8CAGtC,8OAAC;oCAAI,WAAU;;wCAAuB;wCACnB,WAAW,aAAa;wCAAC;;;;;;;;;;;;;wBAI7C,WAAW,QAAQ,kBAClB,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAI,WAAU;;sDACb,8OAAC,gOAAU;4CAAC,WAAU;;;;;;sDACtB,8OAAC;4CAAK,WAAU;sDAAqC;;;;;;;;;;;;8CAIvD,8OAAC;oCAAK,WAAU;;wCACb,WAAW,QAAQ,CAAC,IAAI;wCAAC;wCAAI,WAAW,QAAQ,CAAC,EAAE;;;;;;;8CAEtD,8OAAC;oCAAE,WAAU;8CAAqC;;;;;;;;;;;;sCAMtD,8OAAC;4BAAI,WAAU;;8CACb,8OAAC,qIAAM;oCAAC,SAAS;oCAAQ,WAAU;oCAAS,SAAQ;;sDAClD,8OAAC,iNAAK;4CAAC,WAAU;;;;;;wCAAiB;;;;;;;8CAGpC,8OAAC,qIAAM;oCACL,SAAS;oCACT,SAAQ;oCACR,WAAU;8CACX;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQb"}},
    {"offset": {"line": 3046, "column": 0}, "map": {"version":3,"sources":["file:///home/rajunew/aa/decchessd/lib/adaptive-ai.ts"],"sourcesContent":["import {\n  type GameState,\n  getAllLegalMoves,\n  makeMove,\n  type Piece,\n  type PieceType,\n  type Square,\n} from \"./chess-engine\";\nimport {\n  STOCKFISH_LEVELS,\n  getMoveGrade,\n  STOCKFISH_THRESHOLDS,\n  calculateEloChange,\n} from \"./stockfish-eval\";\n\nexport type DifficultyLevel = 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10;\n\nexport type PlayerStats = {\n  gamesPlayed: number;\n  wins: number;\n  losses: number;\n  draws: number;\n  blunders: number;\n  mistakes: number;\n  inaccuracies: number;\n  goodMoves: number;\n  excellentMoves: number;\n  brilliantMoves: number;\n  averageAccuracy: number;\n  currentStreak: number;\n  skillRating: number;\n  tacticsScore: number;\n  positionScore: number;\n  endgameScore: number;\n  totalCentipawnLoss: number;\n  totalMovesAnalyzed: number;\n};\n\nexport type MoveEvaluation = {\n  from: Square;\n  to: Square;\n  score: number;\n  type:\n    | \"blunder\"\n    | \"mistake\"\n    | \"inaccuracy\"\n    | \"good\"\n    | \"excellent\"\n    | \"brilliant\";\n  bestMove?: { from: Square; to: Square; score: number };\n  centipawnLoss: number;\n  explanation?: string;\n};\n\nconst PIECE_VALUES: Record<PieceType, number> = {\n  p: 100,\n  n: 320,\n  b: 330,\n  r: 500,\n  q: 900,\n  k: 20000,\n};\n\nconst PAWN_TABLE = [\n  [0, 0, 0, 0, 0, 0, 0, 0],\n  [50, 50, 50, 50, 50, 50, 50, 50],\n  [10, 10, 20, 30, 30, 20, 10, 10],\n  [5, 5, 10, 25, 25, 10, 5, 5],\n  [0, 0, 0, 20, 20, 0, 0, 0],\n  [5, -5, -10, 0, 0, -10, -5, 5],\n  [5, 10, 10, -20, -20, 10, 10, 5],\n  [0, 0, 0, 0, 0, 0, 0, 0],\n];\n\nconst KNIGHT_TABLE = [\n  [-50, -40, -30, -30, -30, -30, -40, -50],\n  [-40, -20, 0, 0, 0, 0, -20, -40],\n  [-30, 0, 10, 15, 15, 10, 0, -30],\n  [-30, 5, 15, 20, 20, 15, 5, -30],\n  [-30, 0, 15, 20, 20, 15, 0, -30],\n  [-30, 5, 10, 15, 15, 10, 5, -30],\n  [-40, -20, 0, 5, 5, 0, -20, -40],\n  [-50, -40, -30, -30, -30, -30, -40, -50],\n];\n\nconst BISHOP_TABLE = [\n  [-20, -10, -10, -10, -10, -10, -10, -20],\n  [-10, 0, 0, 0, 0, 0, 0, -10],\n  [-10, 0, 5, 10, 10, 5, 0, -10],\n  [-10, 5, 5, 10, 10, 5, 5, -10],\n  [-10, 0, 10, 10, 10, 10, 0, -10],\n  [-10, 10, 10, 10, 10, 10, 10, -10],\n  [-10, 5, 0, 0, 0, 0, 5, -10],\n  [-20, -10, -10, -10, -10, -10, -10, -20],\n];\n\nconst ROOK_TABLE = [\n  [0, 0, 0, 0, 0, 0, 0, 0],\n  [5, 10, 10, 10, 10, 10, 10, 5],\n  [-5, 0, 0, 0, 0, 0, 0, -5],\n  [-5, 0, 0, 0, 0, 0, 0, -5],\n  [-5, 0, 0, 0, 0, 0, 0, -5],\n  [-5, 0, 0, 0, 0, 0, 0, -5],\n  [-5, 0, 0, 0, 0, 0, 0, -5],\n  [0, 0, 0, 5, 5, 0, 0, 0],\n];\n\nconst KING_TABLE = [\n  [-30, -40, -40, -50, -50, -40, -40, -30],\n  [-30, -40, -40, -50, -50, -40, -40, -30],\n  [-30, -40, -40, -50, -50, -40, -40, -30],\n  [-30, -40, -40, -50, -50, -40, -40, -30],\n  [-20, -30, -30, -40, -40, -30, -30, -20],\n  [-10, -20, -20, -20, -20, -20, -20, -10],\n  [20, 20, 0, 0, 0, 0, 20, 20],\n  [20, 30, 10, 0, 0, 10, 30, 20],\n];\n\nfunction getPieceSquareValue(piece: Piece, row: number, col: number): number {\n  if (!piece) return 0;\n\n  const isWhite = piece.color === \"w\";\n  const r = isWhite ? row : 7 - row;\n\n  let table: number[][];\n  switch (piece.type) {\n    case \"p\":\n      table = PAWN_TABLE;\n      break;\n    case \"n\":\n      table = KNIGHT_TABLE;\n      break;\n    case \"b\":\n      table = BISHOP_TABLE;\n      break;\n    case \"r\":\n      table = ROOK_TABLE;\n      break;\n    case \"q\":\n      table = BISHOP_TABLE;\n      break;\n    case \"k\":\n      table = KING_TABLE;\n      break;\n    default:\n      return 0;\n  }\n\n  return table[r][col];\n}\n\nexport function evaluatePosition(state: GameState): number {\n  let score = 0;\n\n  for (let row = 0; row < 8; row++) {\n    for (let col = 0; col < 8; col++) {\n      const piece = state.board[row][col];\n      if (piece) {\n        const value =\n          PIECE_VALUES[piece.type] + getPieceSquareValue(piece, row, col);\n        score += piece.color === \"w\" ? value : -value;\n      }\n    }\n  }\n\n  if (state.isCheckmate) {\n    score = state.turn === \"w\" ? -99999 : 99999;\n  }\n\n  return score;\n}\n\nfunction minimax(\n  state: GameState,\n  depth: number,\n  alpha: number,\n  beta: number,\n  maximizing: boolean,\n  noiseLevel: number,\n  nodeCount: { count: number },\n  maxNodes: number\n): number {\n  nodeCount.count++;\n\n  if (nodeCount.count > maxNodes) {\n    return evaluatePosition(state);\n  }\n\n  if (depth === 0 || state.isCheckmate || state.isStalemate || state.isDraw) {\n    const eval_ = evaluatePosition(state);\n    const noise = (Math.random() - 0.5) * noiseLevel * 100;\n    return eval_ + noise;\n  }\n\n  const moves = getAllLegalMoves(state);\n\n  const maxMoves = Math.min(moves.length, depth > 1 ? 10 : 20);\n  const limitedMoves = moves.slice(0, maxMoves);\n\n  if (maximizing) {\n    let maxEval = Number.NEGATIVE_INFINITY;\n    for (const { from, to } of limitedMoves) {\n      const newState = makeMove(state, from, to);\n      if (newState) {\n        const eval_ = minimax(\n          newState,\n          depth - 1,\n          alpha,\n          beta,\n          false,\n          noiseLevel,\n          nodeCount,\n          maxNodes\n        );\n        maxEval = Math.max(maxEval, eval_);\n        alpha = Math.max(alpha, eval_);\n        if (beta <= alpha) break;\n      }\n    }\n    return maxEval;\n  } else {\n    let minEval = Number.POSITIVE_INFINITY;\n    for (const { from, to } of limitedMoves) {\n      const newState = makeMove(state, from, to);\n      if (newState) {\n        const eval_ = minimax(\n          newState,\n          depth - 1,\n          alpha,\n          beta,\n          true,\n          noiseLevel,\n          nodeCount,\n          maxNodes\n        );\n        minEval = Math.min(minEval, eval_);\n        beta = Math.min(beta, eval_);\n        if (beta <= alpha) break;\n      }\n    }\n    return minEval;\n  }\n}\n\nexport async function getAIMoveAsync(\n  state: GameState,\n  difficulty: DifficultyLevel,\n  playerStats: PlayerStats\n): Promise<{ from: Square; to: Square } | null> {\n  return new Promise((resolve) => {\n    // Use setTimeout to allow UI to update\n    setTimeout(() => {\n      const result = getAIMove(state, difficulty, playerStats);\n      resolve(result);\n    }, 10);\n  });\n}\n\nexport function getAIMove(\n  state: GameState,\n  difficulty: DifficultyLevel,\n  playerStats: PlayerStats\n): { from: Square; to: Square } | null {\n  const moves = getAllLegalMoves(state);\n  if (moves.length === 0) return null;\n\n  const levelParams = STOCKFISH_LEVELS[difficulty];\n  const depth = Math.min(levelParams.depth + 1, 4); // Increased depth for Stockfish 17\n  const { errorRate, blunderRate } = levelParams;\n\n  const noiseLevel = Math.max(0, (10 - difficulty) / 5);\n\n  // Occasionally make a random move (blunder)\n  if (Math.random() < blunderRate) {\n    return moves[Math.floor(Math.random() * moves.length)];\n  }\n\n  const maxNodes = 8000;\n  const nodeCount = { count: 0 };\n\n  const scoredMoves: { move: (typeof moves)[0]; score: number }[] = [];\n\n  for (const move of moves) {\n    if (nodeCount.count > maxNodes) break;\n\n    const newState = makeMove(state, move.from, move.to);\n    if (newState) {\n      const score = minimax(\n        newState,\n        depth - 1,\n        Number.NEGATIVE_INFINITY,\n        Number.POSITIVE_INFINITY,\n        state.turn === \"b\",\n        noiseLevel,\n        nodeCount,\n        maxNodes\n      );\n      scoredMoves.push({ move, score });\n    }\n  }\n\n  scoredMoves.sort((a, b) =>\n    state.turn === \"w\" ? b.score - a.score : a.score - b.score\n  );\n\n  // At lower difficulties, sometimes pick a suboptimal move\n  if (Math.random() < errorRate && scoredMoves.length > 1) {\n    const poolSize = Math.min(5, scoredMoves.length);\n    const index = Math.floor(Math.random() * poolSize);\n    return scoredMoves[index].move;\n  }\n\n  return scoredMoves[0]?.move || moves[0];\n}\n\nexport function evaluatePlayerMove(\n  stateBefore: GameState,\n  from: Square,\n  to: Square\n): MoveEvaluation {\n  const moves = getAllLegalMoves(stateBefore);\n\n  const maxNodes = 4000;\n  const nodeCount = { count: 0 };\n\n  const scoredMoves: { from: Square; to: Square; score: number }[] = [];\n\n  for (const move of moves) {\n    if (nodeCount.count > maxNodes) break;\n\n    const newState = makeMove(stateBefore, move.from, move.to);\n    if (newState) {\n      const score = minimax(\n        newState,\n        2, // Increased depth for better accuracy\n        Number.NEGATIVE_INFINITY,\n        Number.POSITIVE_INFINITY,\n        stateBefore.turn === \"b\",\n        0,\n        nodeCount,\n        maxNodes\n      );\n      scoredMoves.push({ from: move.from, to: move.to, score });\n    }\n  }\n\n  scoredMoves.sort((a, b) =>\n    stateBefore.turn === \"w\" ? b.score - a.score : a.score - b.score\n  );\n\n  const bestMove = scoredMoves[0];\n  const playerMove = scoredMoves.find((m) => m.from === from && m.to === to);\n\n  if (!bestMove || !playerMove) {\n    return { from, to, score: 0, type: \"good\", centipawnLoss: 0 };\n  }\n\n  const centipawnLoss =\n    stateBefore.turn === \"w\"\n      ? bestMove.score - playerMove.score\n      : playerMove.score - bestMove.score;\n\n  const type = getMoveGrade(centipawnLoss);\n\n  return {\n    from,\n    to,\n    score: playerMove.score,\n    type,\n    centipawnLoss,\n    bestMove:\n      centipawnLoss > STOCKFISH_THRESHOLDS.GOOD\n        ? { from: bestMove.from, to: bestMove.to, score: bestMove.score }\n        : undefined,\n  };\n}\n\nexport function createDefaultStats(initialElo = 1000): PlayerStats {\n  return {\n    gamesPlayed: 0,\n    wins: 0,\n    losses: 0,\n    draws: 0,\n    blunders: 0,\n    mistakes: 0,\n    inaccuracies: 0,\n    goodMoves: 0,\n    excellentMoves: 0,\n    brilliantMoves: 0,\n    averageAccuracy: 70,\n    currentStreak: 0,\n    skillRating: initialElo,\n    tacticsScore: 50,\n    positionScore: 50,\n    endgameScore: 50,\n    totalCentipawnLoss: 0,\n    totalMovesAnalyzed: 0,\n  };\n}\n\nexport function updateStatsAfterMove(\n  stats: PlayerStats,\n  evaluation: MoveEvaluation\n): PlayerStats {\n  const newStats = { ...stats };\n\n  switch (evaluation.type) {\n    case \"blunder\":\n      newStats.blunders++;\n      break;\n    case \"mistake\":\n      newStats.mistakes++;\n      break;\n    case \"inaccuracy\":\n      newStats.inaccuracies++;\n      break;\n    case \"good\":\n      newStats.goodMoves++;\n      break;\n    case \"excellent\":\n      newStats.excellentMoves++;\n      break;\n    case \"brilliant\":\n      newStats.brilliantMoves++;\n      break;\n  }\n\n  newStats.totalCentipawnLoss += Math.max(0, evaluation.centipawnLoss);\n  newStats.totalMovesAnalyzed++;\n\n  const avgCentipawnLoss =\n    newStats.totalCentipawnLoss / newStats.totalMovesAnalyzed;\n  newStats.averageAccuracy = Math.round(\n    Math.max(50, 100 - avgCentipawnLoss / 3)\n  );\n\n  return newStats;\n}\n\nexport function updateStatsAfterGame(\n  stats: PlayerStats,\n  result: \"win\" | \"loss\" | \"draw\",\n  aiDifficulty: number\n): PlayerStats {\n  const newStats = { ...stats };\n  newStats.gamesPlayed++;\n\n  const aiElo = STOCKFISH_LEVELS[aiDifficulty]?.elo || 1000;\n  const eloChange = calculateEloChange(stats.skillRating, aiElo, result);\n\n  switch (result) {\n    case \"win\":\n      newStats.wins++;\n      newStats.currentStreak = Math.max(0, newStats.currentStreak) + 1;\n      break;\n    case \"loss\":\n      newStats.losses++;\n      newStats.currentStreak = Math.min(0, newStats.currentStreak) - 1;\n      break;\n    case \"draw\":\n      newStats.draws++;\n      newStats.currentStreak = 0;\n      break;\n  }\n\n  newStats.skillRating = Math.max(100, newStats.skillRating + eloChange);\n\n  return newStats;\n}\n\nexport function generateMoveHint(evaluation: MoveEvaluation): string {\n  const cpLoss = evaluation.centipawnLoss;\n\n  if (evaluation.type === \"brilliant\")\n    return \"Brilliant! You found an exceptional move!\";\n  if (evaluation.type === \"excellent\")\n    return \"Excellent move! Nearly perfect play.\";\n  if (evaluation.type === \"good\") return \"Good move. Solid continuation.\";\n  if (evaluation.type === \"inaccuracy\") {\n    return `Inaccuracy (${cpLoss} cp lost). ${\n      evaluation.bestMove\n        ? `Best was ${evaluation.bestMove.from}-${evaluation.bestMove.to}`\n        : \"\"\n    }`;\n  }\n  if (evaluation.type === \"mistake\") {\n    return `Mistake (${cpLoss} cp lost). ${\n      evaluation.bestMove\n        ? `${evaluation.bestMove.from}-${evaluation.bestMove.to} was stronger.`\n        : \"\"\n    }`;\n  }\n  if (evaluation.type === \"blunder\") {\n    return `Blunder! (${cpLoss} cp lost). ${\n      evaluation.bestMove\n        ? `You missed ${evaluation.bestMove.from}-${evaluation.bestMove.to}.`\n        : \"\"\n    }`;\n  }\n  return \"\";\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3757, "column": 0}, "map": {"version":3,"sources":["file:///home/rajunew/aa/decchessd/lib/supabase/client.ts"],"sourcesContent":["import { createBrowserClient } from \"@supabase/ssr\"\n\nexport function createClient() {\n  return createBrowserClient(process.env.NEXT_PUBLIC_SUPABASE_URL!, process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!)\n}\n"],"names":[],"mappings":";;;;AAAA;AAAA;;AAEO,SAAS;IACd,OAAO,IAAA,iMAAmB;AAC5B"}},
    {"offset": {"line": 3771, "column": 0}, "map": {"version":3,"sources":["file:///home/rajunew/aa/decchessd/components/chess-game.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useCallback, useEffect, useRef } from \"react\";\n//import { Icon } from \"@iconify/react\";\nimport { ChessBoard } from \"./chess-board\";\nimport { MoveHistoryPanel } from \"./move-history-panel\";\nimport { AIFeedback } from \"./ai-feedback\";\nimport { GameSetupModal } from \"./game-setup-modal\";\nimport { EvaluationBar } from \"./evaluation-bar\";\nimport { GameControls } from \"./game-controls\";\nimport { BlunderAlert } from \"./blunder-alert\";\nimport {\n  type GameState,\n  createInitialState,\n  makeMove,\n  getValidMoves,\n  moveToAlgebraic,\n  type Square,\n} from \"@/lib/chess-engine\";\nimport {\n  type DifficultyLevel,\n  type PlayerStats,\n  createDefaultStats,\n  getAIMoveAsync,\n  evaluatePlayerMove,\n  updateStatsAfterMove,\n  updateStatsAfterGame,\n  type MoveEvaluation,\n  evaluatePosition,\n} from \"@/lib/adaptive-ai\";\nimport {\n  eloToDifficulty,\n  getAdaptiveDifficulty,\n  STOCKFISH_LEVELS,\n} from \"@/lib/stockfish-eval\";\nimport { Button } from \"@/components/ui/button\";\nimport { createClient } from \"@/lib/supabase/client\";\nimport type { User } from \"@supabase/supabase-js\";\n\nexport function ChessGame() {\n  const [gameState, setGameState] = useState<GameState>(createInitialState());\n  const [gameHistory, setGameHistory] = useState<GameState[]>([\n    createInitialState(),\n  ]);\n  const [historyIndex, setHistoryIndex] = useState(0);\n  const [selectedSquare, setSelectedSquare] = useState<Square | null>(null);\n  const [validMoves, setValidMoves] = useState<Square[]>([]);\n  const [lastMove, setLastMove] = useState<{ from: Square; to: Square } | null>(\n    null\n  );\n  const [aiLastMove, setAiLastMove] = useState<{\n    from: Square;\n    to: Square;\n  } | null>(null); // Track AI move separately\n  const [playerStats, setPlayerStats] = useState<PlayerStats | null>(null);\n  const [isThinking, setIsThinking] = useState(false);\n  const [moveNotations, setMoveNotations] = useState<string[]>([]);\n  const [currentEvaluation, setCurrentEvaluation] =\n    useState<MoveEvaluation | null>(null);\n  const [gameEvaluations, setGameEvaluations] = useState<MoveEvaluation[]>([]);\n  const [aiAnalysis, setAIAnalysis] = useState<string>(\"\");\n  const [isAnalyzing, setIsAnalyzing] = useState(false);\n  const [gameStarted, setGameStarted] = useState(false);\n  const [playerColor, setPlayerColor] = useState<\"w\" | \"b\">(\"w\");\n  const [showSetupModal, setShowSetupModal] = useState(false);\n  const [currentDifficulty, setCurrentDifficulty] =\n    useState<DifficultyLevel>(5);\n  const [positionEval, setPositionEval] = useState<number>(0);\n  const [moveTimes, setMoveTimes] = useState<number[]>([]); // Track move times\n  const [moveStartTime, setMoveStartTime] = useState<number>(Date.now());\n  const [user, setUser] = useState<User | null>(null);\n  const [initialEloSet, setInitialEloSet] = useState(false); // Track if ELO was set\n  const [showBlunderAlert, setShowBlunderAlert] = useState(false); // Blunder alert\n  const [pendingBlunderEval, setPendingBlunderEval] =\n    useState<MoveEvaluation | null>(null);\n  const [isLoadingSession, setIsLoadingSession] = useState(true);\n\n  const aiMoveInProgress = useRef(false);\n  const sessionSaveTimeout = useRef<NodeJS.Timeout | null>(null);\n\n  useEffect(() => {\n    const supabase = createClient();\n\n    const checkAuth = async () => {\n      const {\n        data: { user },\n      } = await supabase.auth.getUser();\n      setUser(user);\n\n      if (user) {\n        // Load session from server\n        try {\n          const res = await fetch(\"/api/session\");\n          const { session, profile } = await res.json();\n\n          if (profile) {\n            setPlayerStats({\n              gamesPlayed: profile.games_played,\n              wins: profile.wins,\n              losses: profile.losses,\n              draws: profile.draws,\n              blunders: profile.total_blunders,\n              mistakes: profile.total_mistakes,\n              inaccuracies: profile.total_inaccuracies,\n              goodMoves: profile.total_good_moves,\n              excellentMoves: profile.total_excellent_moves,\n              brilliantMoves: profile.total_brilliant_moves,\n              averageAccuracy: profile.average_accuracy,\n              currentStreak: profile.current_streak,\n              skillRating: profile.skill_rating,\n              tacticsScore: 50,\n              positionScore: 50,\n              endgameScore: 50,\n              totalCentipawnLoss: 0,\n              totalMovesAnalyzed: 0,\n            });\n            setInitialEloSet(profile.initial_elo_set);\n          }\n\n          if (session) {\n            setGameState(session.game_state);\n            setGameHistory(session.game_history);\n            setMoveNotations(session.move_notations || []);\n            setGameEvaluations(session.game_evaluations || []);\n            setPlayerColor(session.player_color);\n            setCurrentDifficulty(session.current_difficulty);\n            setHistoryIndex(session.history_index);\n            setMoveTimes(session.move_times || []);\n            setGameStarted(true);\n          } else if (!profile?.initial_elo_set) {\n            setShowSetupModal(true);\n          }\n        } catch (e) {\n          console.error(\"Failed to load session:\", e);\n        }\n      } else {\n        // Guest mode - load from localStorage\n        const saved = localStorage.getItem(\"chessAI_playerStats\");\n        if (saved) {\n          try {\n            const parsed = JSON.parse(saved);\n            setPlayerStats(parsed);\n            setInitialEloSet(parsed.gamesPlayed > 0);\n          } catch {\n            setPlayerStats(null);\n          }\n        }\n\n        // Check for saved session in localStorage\n        const savedSession = localStorage.getItem(\"chessAI_session\");\n        if (savedSession) {\n          try {\n            const session = JSON.parse(savedSession);\n            setGameState(session.gameState);\n            setGameHistory(session.gameHistory);\n            setMoveNotations(session.moveNotations || []);\n            setGameEvaluations(session.gameEvaluations || []);\n            setPlayerColor(session.playerColor);\n            setCurrentDifficulty(session.currentDifficulty);\n            setHistoryIndex(session.historyIndex);\n            setMoveTimes(session.moveTimes || []);\n            setGameStarted(true);\n          } catch {\n            // Ignore\n          }\n        }\n      }\n\n      setIsLoadingSession(false);\n    };\n\n    checkAuth();\n\n    const {\n      data: { subscription },\n    } = supabase.auth.onAuthStateChange((_, session) => {\n      setUser(session?.user ?? null);\n    });\n\n    return () => subscription.unsubscribe();\n  }, []);\n\n  useEffect(() => {\n    if (playerStats && !user) {\n      localStorage.setItem(\"chessAI_playerStats\", JSON.stringify(playerStats));\n    }\n  }, [playerStats, user]);\n\n  useEffect(() => {\n    if (!gameStarted || isLoadingSession) return;\n\n    if (sessionSaveTimeout.current) {\n      clearTimeout(sessionSaveTimeout.current);\n    }\n\n    sessionSaveTimeout.current = setTimeout(() => {\n      const sessionData = {\n        gameState,\n        gameHistory,\n        moveNotations,\n        gameEvaluations,\n        playerColor,\n        currentDifficulty,\n        historyIndex,\n        moveTimes,\n      };\n\n      if (user) {\n        fetch(\"/api/session\", {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify(sessionData),\n        }).catch(console.error);\n      } else {\n        localStorage.setItem(\"chessAI_session\", JSON.stringify(sessionData));\n      }\n    }, 2000);\n\n    return () => {\n      if (sessionSaveTimeout.current) {\n        clearTimeout(sessionSaveTimeout.current);\n      }\n    };\n  }, [\n    gameState,\n    gameHistory,\n    moveNotations,\n    gameEvaluations,\n    playerColor,\n    currentDifficulty,\n    historyIndex,\n    moveTimes,\n    gameStarted,\n    user,\n    isLoadingSession,\n  ]);\n\n  useEffect(() => {\n    setPositionEval(evaluatePosition(gameState));\n  }, [gameState]);\n\n  useEffect(() => {\n    if (!playerStats) return;\n    if (gameState.isCheckmate || gameState.isStalemate || gameState.isDraw) {\n      let result: \"win\" | \"loss\" | \"draw\";\n      let resultNum: number;\n      if (gameState.isCheckmate) {\n        result = gameState.turn === playerColor ? \"loss\" : \"win\";\n        resultNum = result === \"win\" ? 1 : 0;\n      } else {\n        result = \"draw\";\n        resultNum = 0.5;\n      }\n\n      const prevElo = playerStats.skillRating;\n      const newStats = updateStatsAfterGame(\n        playerStats,\n        result,\n        currentDifficulty\n      );\n      setPlayerStats(newStats);\n\n      // Save to database if logged in\n      if (user) {\n        const scores: number[] = gameEvaluations.map((e) => {\n          switch (e.type) {\n            case \"brilliant\":\n            case \"excellent\":\n              return 1.0;\n            case \"good\":\n              return 0.9;\n            case \"inaccuracy\":\n              return 0.5;\n            case \"mistake\":\n              return 0.25;\n            case \"blunder\":\n              return 0.0;\n            default:\n              return 0.75;\n          }\n        });\n        const ams =\n          scores.length > 0\n            ? scores.reduce((a, b) => a + b, 0) / scores.length\n            : 0.75;\n        const variance =\n          scores.length > 1\n            ? scores.reduce((sum, s) => sum + Math.pow(s - ams, 2), 0) /\n              scores.length\n            : 0;\n        const stdDev = Math.sqrt(variance);\n        const avgTime =\n          moveTimes.length > 0\n            ? moveTimes.reduce((a, b) => a + b, 0) / moveTimes.length\n            : 0;\n\n        fetch(\"/api/save-game\", {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({\n            result: resultNum,\n            playerColor,\n            aiElo: STOCKFISH_LEVELS[currentDifficulty]?.elo || 1000,\n            totalMoves: gameEvaluations.length,\n            excellentMoves: gameEvaluations.filter(\n              (e) => e.type === \"excellent\" || e.type === \"brilliant\"\n            ).length,\n            goodMoves: gameEvaluations.filter((e) => e.type === \"good\").length,\n            inaccurateMoves: gameEvaluations.filter(\n              (e) => e.type === \"inaccuracy\"\n            ).length,\n            mistakes: gameEvaluations.filter((e) => e.type === \"mistake\")\n              .length,\n            blunders: gameEvaluations.filter((e) => e.type === \"blunder\")\n              .length,\n            ams,\n            stdDeviation: stdDev,\n            avgTimePerMove: avgTime,\n            playerEloBefore: prevElo,\n            playerEloAfter: newStats.skillRating,\n          }),\n        }).catch(console.error);\n\n        // Clear session\n        fetch(\"/api/session\", { method: \"DELETE\" }).catch(console.error);\n      } else {\n        localStorage.removeItem(\"chessAI_session\");\n      }\n    }\n  }, [\n    gameState.isCheckmate,\n    gameState.isStalemate,\n    gameState.isDraw,\n    gameState.turn,\n    playerColor,\n    currentDifficulty,\n    playerStats,\n    user,\n    gameEvaluations,\n    moveTimes,\n  ]);\n\n  // AI move effect\n  useEffect(() => {\n    if (!gameStarted || !playerStats) return;\n    if (gameState.turn === playerColor) return;\n    if (gameState.isCheckmate || gameState.isStalemate || gameState.isDraw)\n      return;\n    if (aiMoveInProgress.current) return;\n\n    const makeAIMove = async () => {\n      aiMoveInProgress.current = true;\n      setIsThinking(true);\n\n      await new Promise((resolve) => setTimeout(resolve, 300));\n\n      try {\n        const aiMove = await getAIMoveAsync(\n          gameState,\n          currentDifficulty,\n          playerStats\n        );\n\n        if (aiMove) {\n          const newState = makeMove(gameState, aiMove.from, aiMove.to);\n          if (newState) {\n            setGameState(newState);\n            setGameHistory((prev) => [\n              ...prev.slice(0, historyIndex + 1),\n              newState,\n            ]);\n            setHistoryIndex((prev) => prev + 1);\n            setAiLastMove(aiMove); // Track AI move\n            setLastMove(null); // Clear player's last move highlight\n            const notation = moveToAlgebraic(\n              gameState,\n              newState.history[newState.history.length - 1]\n            );\n            setMoveNotations((prev) => [...prev, notation]);\n            setMoveStartTime(Date.now()); // Reset timer for player\n          }\n        }\n      } catch (error) {\n        console.error(\"AI move error:\", error);\n      } finally {\n        setIsThinking(false);\n        aiMoveInProgress.current = false;\n      }\n    };\n\n    makeAIMove();\n  }, [\n    gameState,\n    gameStarted,\n    playerColor,\n    currentDifficulty,\n    playerStats,\n    historyIndex,\n  ]);\n\n  const requestAIAnalysis = async (\n    state: GameState,\n    evaluation: MoveEvaluation\n  ) => {\n    if (evaluation.type === \"good\" || evaluation.type === \"excellent\") return;\n\n    setIsAnalyzing(true);\n    try {\n      const response = await fetch(\"/api/analyze-move\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          gameState: state,\n          evaluation,\n          moveHistory: moveNotations,\n          playerStats: playerStats\n            ? {\n                skillRating: playerStats.skillRating,\n                averageAccuracy: playerStats.averageAccuracy,\n              }\n            : null,\n          allEvaluations: gameEvaluations,\n          moveTimes,\n        }),\n      });\n      const data = await response.json();\n      setAIAnalysis(data.analysis);\n    } catch (error) {\n      console.error(\"Failed to get AI analysis:\", error);\n    } finally {\n      setIsAnalyzing(false);\n    }\n  };\n\n  const handleSquareClick = useCallback(\n    (square: Square) => {\n      if (!gameStarted || !playerStats) return;\n      if (gameState.turn !== playerColor) return;\n      if (isThinking) return;\n      if (gameState.isCheckmate || gameState.isStalemate || gameState.isDraw)\n        return;\n\n      const [row, col] = [\n        8 - Number.parseInt(square[1]),\n        square.charCodeAt(0) - 97,\n      ];\n      const clickedPiece = gameState.board[row]?.[col];\n\n      if (selectedSquare) {\n        if (clickedPiece && clickedPiece.color === playerColor) {\n          setSelectedSquare(square);\n          setValidMoves(getValidMoves(gameState, square));\n          return;\n        }\n\n        if (validMoves.includes(square)) {\n          const stateBefore = gameState;\n          const newState = makeMove(gameState, selectedSquare, square);\n\n          if (newState) {\n            const moveTime = (Date.now() - moveStartTime) / 1000;\n            setMoveTimes((prev) => [...prev, moveTime]);\n\n            const evaluation = evaluatePlayerMove(\n              stateBefore,\n              selectedSquare,\n              square\n            );\n\n            if (\n              evaluation.type === \"blunder\" ||\n              evaluation.type === \"mistake\"\n            ) {\n              setPendingBlunderEval(evaluation);\n              setShowBlunderAlert(true);\n              // Still make the move but show alert\n            }\n\n            setCurrentEvaluation(evaluation);\n            setGameEvaluations((prev) => [...prev, evaluation]);\n            setPlayerStats((prev) =>\n              prev ? updateStatsAfterMove(prev, evaluation) : prev\n            );\n\n            if (evaluation.type !== \"good\" && evaluation.type !== \"excellent\") {\n              requestAIAnalysis(stateBefore, evaluation);\n            } else {\n              setAIAnalysis(\"\");\n            }\n\n            setGameState(newState);\n            setGameHistory((prev) => [\n              ...prev.slice(0, historyIndex + 1),\n              newState,\n            ]);\n            setHistoryIndex((prev) => prev + 1);\n            setLastMove({ from: selectedSquare, to: square });\n            setAiLastMove(null); // Clear AI move highlight\n            const notation = moveToAlgebraic(\n              stateBefore,\n              newState.history[newState.history.length - 1]\n            );\n            setMoveNotations((prev) => [...prev, notation]);\n\n            const newDifficulty = getAdaptiveDifficulty(\n              eloToDifficulty(playerStats.skillRating),\n              playerStats,\n              gameEvaluations\n            ) as DifficultyLevel;\n            setCurrentDifficulty(newDifficulty);\n          }\n        }\n\n        setSelectedSquare(null);\n        setValidMoves([]);\n      } else {\n        if (clickedPiece && clickedPiece.color === playerColor) {\n          setSelectedSquare(square);\n          setValidMoves(getValidMoves(gameState, square));\n        }\n      }\n    },\n    [\n      gameState,\n      selectedSquare,\n      validMoves,\n      gameStarted,\n      playerColor,\n      isThinking,\n      playerStats,\n      gameEvaluations,\n      historyIndex,\n      moveStartTime,\n    ]\n  );\n\n  const handleBlunderUndo = () => {\n    if (historyIndex > 0) {\n      const newIndex = Math.max(0, historyIndex - 2);\n      setHistoryIndex(newIndex);\n      setGameState(gameHistory[newIndex]);\n      setMoveNotations((prev) => prev.slice(0, newIndex));\n      setGameEvaluations((prev) => prev.slice(0, -1));\n      setMoveTimes((prev) => prev.slice(0, -1));\n      setSelectedSquare(null);\n      setValidMoves([]);\n      setLastMove(null);\n      setCurrentEvaluation(null);\n      setMoveStartTime(Date.now());\n      setAiLastMove(null);\n    }\n    setShowBlunderAlert(false);\n    setPendingBlunderEval(null);\n  };\n\n  const handleStartGame = (color: \"w\" | \"b\", initialElo: number) => {\n    const stats = playerStats || createDefaultStats(initialElo);\n    if (!playerStats) {\n      stats.skillRating = initialElo;\n    }\n    setPlayerStats(stats);\n    setPlayerColor(color);\n    const difficulty = eloToDifficulty(stats.skillRating) as DifficultyLevel;\n    setCurrentDifficulty(difficulty);\n\n    const initialState = createInitialState();\n    setGameState(initialState);\n    setGameHistory([initialState]);\n    setHistoryIndex(0);\n    setSelectedSquare(null);\n    setValidMoves([]);\n    setLastMove(null);\n    setAiLastMove(null);\n    setMoveNotations([]);\n    setCurrentEvaluation(null);\n    setGameEvaluations([]);\n    setAIAnalysis(\"\");\n    setMoveTimes([]);\n    setMoveStartTime(Date.now());\n    setShowSetupModal(false);\n    setInitialEloSet(true);\n    aiMoveInProgress.current = false;\n    setGameStarted(true);\n\n    // Update profile if logged in\n    if (user) {\n      const supabase = createClient();\n      supabase\n        .from(\"player_profiles\")\n        .update({\n          initial_elo_set: true,\n          preferred_color: color,\n          skill_rating: initialElo,\n        })\n        .eq(\"id\", user.id)\n        .then(() => {});\n    }\n  };\n\n  const handleUndo = () => {\n    if (historyIndex > 0) {\n      const newIndex = Math.max(0, historyIndex - 2);\n      setHistoryIndex(newIndex);\n      setGameState(gameHistory[newIndex]);\n      setMoveNotations((prev) => prev.slice(0, newIndex));\n      setSelectedSquare(null);\n      setValidMoves([]);\n      setLastMove(null);\n      setAiLastMove(null);\n    }\n  };\n\n  const handleRedo = () => {\n    if (historyIndex < gameHistory.length - 1) {\n      const newIndex = Math.min(gameHistory.length - 1, historyIndex + 2);\n      setHistoryIndex(newIndex);\n      setGameState(gameHistory[newIndex]);\n    }\n  };\n\n  const handleCopyPGN = () => {\n    const pairs: string[] = [];\n    for (let i = 0; i < moveNotations.length; i += 2) {\n      const moveNum = Math.floor(i / 2) + 1;\n      const white = moveNotations[i];\n      const black = moveNotations[i + 1] || \"\";\n      pairs.push(`${moveNum}. ${white} ${black}`);\n    }\n    navigator.clipboard.writeText(pairs.join(\" \"));\n  };\n\n  const handleNewGame = () => {\n    setShowSetupModal(true);\n  };\n\n  const handleCloseModal = () => {\n    if (gameStarted) {\n      setShowSetupModal(false);\n    }\n  };\n\n  useEffect(() => {\n    if (!isLoadingSession && !gameStarted && !initialEloSet) {\n      setShowSetupModal(true);\n    }\n  }, [isLoadingSession, gameStarted, initialEloSet]);\n\n  const isFirstGame = !initialEloSet;\n  const aiElo = STOCKFISH_LEVELS[currentDifficulty]?.elo || 1000;\n\n  if (isLoadingSession) {\n    return (\n      <div className=\"h-screen w-screen bg-background flex items-center justify-center\">\n        <div className=\"text-muted-foreground\">Loading...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"h-screen w-screen bg-background overflow-hidden flex flex-col\">\n      <GameSetupModal\n        open={showSetupModal}\n        onStartGame={handleStartGame}\n        onClose={handleCloseModal}\n        isFirstGame={isFirstGame}\n        currentElo={playerStats?.skillRating || 1000}\n      />\n\n      <BlunderAlert\n        open={showBlunderAlert}\n        evaluation={pendingBlunderEval}\n        onUndo={handleBlunderUndo}\n        onDismiss={() => {\n          setShowBlunderAlert(false);\n          setPendingBlunderEval(null);\n        }}\n      />\n\n      {/* Compact Header */}\n      <header className=\"flex-shrink-0 h-12 px-3 border-b border-border flex items-center justify-between\">\n        <div className=\"flex items-center gap-2\">\n          <div className=\"w-7 h-7 rounded bg-primary flex items-center justify-center text-primary-foreground text-sm font-bold\">\n            C\n          </div>\n          <span className=\"font-bold text-foreground\">ChessMaster</span>\n        </div>\n        <div className=\"flex items-center gap-3\">\n          {gameStarted && playerStats ? (\n            <div className=\"flex items-center gap-3 text-xs\">\n              <span className=\"text-muted-foreground\">\n                ELO:{\" \"}\n                <span className=\"font-mono font-bold text-primary\">\n                  {playerStats.skillRating}\n                </span>\n              </span>\n              <span className=\"text-muted-foreground\">\n                vs AI: <span className=\"font-mono\">~{aiElo}</span>\n              </span>\n              <span className=\"text-muted-foreground\">\n                Lv: <span className=\"font-bold\">{currentDifficulty}</span>\n              </span>\n            </div>\n          ) : (\n            <Button\n              size=\"sm\"\n              onClick={() => setShowSetupModal(true)}\n              className=\"h-7 px-3 text-xs\"\n            >\n              Start Game\n            </Button>\n          )}\n\n          {user ? (\n            <Button\n              size=\"sm\"\n              variant=\"ghost\"\n              className=\"h-7 px-2 text-xs\"\n              onClick={async () => {\n                const supabase = createClient();\n                await supabase.auth.signOut();\n                window.location.reload();\n              }}\n            >\n              Logout\n            </Button>\n          ) : (\n            <Button\n              size=\"sm\"\n              variant=\"ghost\"\n              className=\"h-7 px-2 text-xs\"\n              onClick={() => (window.location.href = \"/auth/login\")}\n            >\n              Login\n            </Button>\n          )}\n        </div>\n      </header>\n\n      {/* Main Content - fills remaining height */}\n      <main className=\"flex-1 min-h-0 flex\">\n        {/* Left: Evaluation Bar */}\n        <div className=\"flex-shrink-0 w-8 p-1 flex items-stretch\">\n          <EvaluationBar evaluation={positionEval} playerColor={playerColor} />\n        </div>\n\n        {/* Center: Chess Board - takes available space */}\n        <div className=\"flex-shrink-0 p-2 flex items-center justify-center\">\n          <ChessBoard\n            gameState={gameState}\n            selectedSquare={selectedSquare}\n            validMoves={validMoves}\n            lastMove={lastMove}\n            aiLastMove={aiLastMove}\n            onSquareClick={handleSquareClick}\n            flipped={playerColor === \"b\"}\n            isThinking={isThinking}\n            playerColor={playerColor}\n          />\n        </div>\n\n        {/* Right: Sidebar - fills remaining width */}\n        <div className=\"flex-1 min-w-0 flex flex-col p-2 pl-0 gap-2\">\n          {/* AI Feedback */}\n          <div className=\"flex-shrink-0\">\n            <AIFeedback\n              evaluation={currentEvaluation}\n              analysis={aiAnalysis}\n              isAnalyzing={isAnalyzing}\n              isThinking={isThinking}\n              playerStats={playerStats}\n              aiElo={aiElo}\n              difficulty={currentDifficulty}\n            />\n          </div>\n\n          {/* Move History - fills remaining space */}\n          <div className=\"flex-1 min-h-0\">\n            <MoveHistoryPanel\n              moveNotations={moveNotations}\n              gameState={gameState}\n              isThinking={isThinking}\n            />\n          </div>\n\n          {/* Game Controls */}\n          <div className=\"flex-shrink-0\">\n            <GameControls\n              onUndo={handleUndo}\n              onRedo={handleRedo}\n              onCopyPGN={handleCopyPGN}\n              onNewGame={handleNewGame}\n              canUndo={historyIndex > 0 && gameStarted}\n              canRedo={historyIndex < gameHistory.length - 1}\n              gameStarted={gameStarted}\n            />\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}